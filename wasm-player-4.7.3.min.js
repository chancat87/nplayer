/*!
 * A web media player that implements W3C MSE and MediaElement v4.7.3
 *
 * Copyright 2020 - 2021 Bilibili, Inc.
 * Released in Wed Dec 29 2021 15:21:26 GMT+0800 (中国标准时间)
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WasmPlayer=t():e.WasmPlayer=t()}(self,(function(){return function(){var e={757:function(e,t,n){e.exports=n(666)},601:function(e,t,n){"use strict";var r=n(81),a=n.n(r),i=n(645),o=n.n(i)()(a());o.push([e.id,".-bwp-internal-container {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    position: relative;\n    min-width: inherit;\n    max-width: inherit;\n    min-height: inherit;\n    max-height: inherit;\n    object-fit: inherit;\n}\n\n.-bwp-internal-render-canvas {\n    width: 100%;\n    height: 100%;\n    display: block;\n    position: relative;\n    object-fit: inherit;\n}\n\n.-bwp-internal-proxy-video-element {\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    display: none;\n    position: absolute;\n    margin: inherit;\n    padding: inherit;\n    object-fit: inherit;\n}\n",""]),t.Z=o},204:function(e,t,n){"use strict";var r=n(81),a=n.n(r),i=n(645),o=n.n(i),s=n(667),u=n.n(s),l=new URL(n(735),n.b),c=new URL(n(400),n.b),d=new URL(n(662),n.b),f=new URL(n(542),n.b),h=new URL(n(195),n.b),p=new URL(n(14),n.b),m=new URL(n(588),n.b),b=o()(a()),v=u()(l),w=u()(c),y=u()(d),g=u()(f),E=u()(h),_=u()(p),T=u()(m);b.push([e.id,".bwp-media-controls {\n    position: absolute;\n    left: 0;\n    bottom: 0;\n    width: inherit;\n    z-index: 5;\n    padding: inherit;\n    margin: inherit;\n    min-width: inherit;\n    max-width: inherit;\n}\n\n.bwp-media-controls-button-panel {\n    height: 48px;\n    line-height: 48px;\n    display: flex;\n    flex-direction: row;\n    transition: opacity 0.5s cubic-bezier(0.25, 0.1, 0.25, 1) 0s;\n}\n\n.bwp-media-controls-button-panel-spacer {\n    flex: 1 1 0%;\n}\n\n.bwp-media-controls-time-wrap {\n    display: flex;\n    color: white;\n}\n\n.bwp-media-controls-btn-wrap {\n    width: 48px;\n    min-width: 48px;\n    height: 48px;\n    position: relative;\n    z-index: 0;\n}\n\n.bwp-media-controls-btn-wrap .bwp-media-controls-btn {\n    width: 36px;\n    height: 36px;\n    position: absolute;\n    left: 6px;\n    top: 6px;\n    background-size: 20px;\n    background-repeat: no-repeat;\n    background-position: center center;\n    font: 400 13.3333px Arial;\n    z-index: 1;\n}\n\n.bwp-media-controls.bwp-media-controls-disabled .bwp-media-controls-btn-wrap .bwp-media-controls-btn {\n    opacity: 0.3;\n    cursor: default;\n}\n\n\n.bwp-media-controls-btn-background {\n    position: absolute;\n    height: 36px;\n    width: 36px;\n    right: 6px;\n    top: 6px;\n    border-radius: 18px;\n    background-size: 24px;\n    transition: width 0.3s ease 0s, opacity 0.25s ease 0s;\n    opacity: 0;\n}\n\n.bwp-media-controls-volume-container {\n    display: flex;\n    justify-content: flex-end;\n    position: relative;\n    transition: min-width 0.3s ease 0s;\n}\n\n.bwp-media-controls-btn-wrap:hover .bwp-media-controls-btn-background,\n    .bwp-media-controls-volume-container:hover .bwp-media-controls-btn-background {\n    background-color: rgba(32, 33, 36, 0.71);\n    opacity: 1;\n}\n\n.bwp-media-controls-volume-container:hover .bwp-media-controls-btn-background {\n    width: 116px;\n}\n\n.bwp-media-controls-volume-track {\n    z-index: 1;\n    height: 4px;\n    width: 0px;\n    cursor: pointer;\n    position: relative;\n    border-radius: 2px;\n    flex: 1 1 0%;\n    display: flex;\n    margin: 22px 0px;\n    transition: width 0.3s ease 0s, opacity 0.5s ease 0s;\n    opacity: 0;\n    background: rgba(255, 255, 255, 0.3);\n}\n\n.bwp-media-controls-volume-container:hover .bwp-media-controls-volume-track {\n    width: 52px;\n    opacity: 1;\n}\n\n.bwp-media-controls-volume-progress {\n    z-index: 1;\n    width: 100%;\n    height: 100%;\n}\n\n.bwp-media-controls-volume-current {\n    width: 100%;\n    height: 4px;\n    position: absolute;\n    border-radius: inherit;\n    transform-origin: 0 0;\n    background: rgba(255, 255, 255, 0.54);\n}\n\n.bwp-media-controls-volume-thumb {\n    position: absolute;\n    opacity: 0;\n    width: 12px;\n    height: 12px;\n    border-radius: 6px;\n    margin-top: -4px;\n    background: white;\n    transition: opacity 0.3s ease 0s;\n    left: calc(100% - 12px);\n}\n\n.bwp-media-controls-volume-track:hover .bwp-media-controls-volume-thumb {\n    opacity: 1;\n}\n\n.bwp-media-controls-timeline {\n    padding: 0px 16px 20px;\n}\n\n.bwp-media-controls-timeline-track {\n    height: 4px;\n    position: relative;\n    display: flex;\n    cursor: pointer;\n    /* border-radius: 2px; */\n    background: rgba(255, 255, 255, 0.3);\n    box-shadow: rgba(0, 0, 0, 0.5) 0px 2px 10px 0px;\n}\n\n.bwp-media-controls-timeline-track:hover .bwp-media-controls-timeline-thumb {\n    opacity: 1;\n}\n\n.bwp-media-controls-timeline-progress {\n    width: 100%;\n    height: 100%;\n    z-index: 5;\n}\n\n.bwp-media-controls-timeline-thumb {\n    width: 12px;\n    height: 12px;\n    opacity: 0;\n    z-index: 3;\n    margin-top: -4px;\n    background: white;\n    position: absolute;\n    border-radius: 50%;\n    transition: opacity 0.3s ease 0s;\n    left: -6px;\n}\n\n.bwp-media-controls-timeline-played {\n    width: 100%;\n    height: inherit;\n    z-index: 2;\n    border-radius: inherit;\n    background: white;\n    position: absolute;\n    left: 0;\n    transform: scaleX(0);\n    transform-origin: 0 0;\n}\n\n.bwp-media-controls-timeline-buffered {\n    width: 100%;\n    height: inherit;\n    z-index: 1;\n    border-radius: inherit;\n    background: rgba(255, 255, 255, 0.54);\n    position: absolute;\n    left: 0;\n    transform: scaleX(0);\n    transform-origin: 0 0;\n}\n\n.bwp-media-controls-icon-play {\n    background-image: -webkit-image-set(url("+v+") 1x);\n}\n\n.bwp-media-controls-icon-pause {\n    background-image: -webkit-image-set(url("+w+") 1x);\n}\n\n.bwp-media-controls-icon-volume {\n    background-image: -webkit-image-set(url("+y+") 1x);\n}\n\n.bwp-media-controls-icon-volume-mute {\n    background-image: -webkit-image-set(url("+g+") 1x);\n}\n\n.bwp-media-controls-icon-fullscreen {\n    background-image: -webkit-image-set(url("+E+") 1x);\n}\n\n.bwp-media-controls-icon-exit-fullscreen {\n    background-image: -webkit-image-set(url("+_+") 1x);\n}\n\n.bwp-media-controls-icon-more {\n    background-image: -webkit-image-set(url("+T+") 1x);\n}\n",""]),t.Z=b},645:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var s=0;s<this.length;s++){var u=this[s][0];null!=u&&(o[u]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);r&&o[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},667:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:function(e){"use strict";e.exports=function(e){return e[1]}},666:function(e){var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var a=t&&t.prototype instanceof b?t:b,i=Object.create(a.prototype),o=new P(r||[]);return i._invoke=function(e,t,n){var r=d;return function(a,i){if(r===h)throw new Error("Generator is already running");if(r===p){if("throw"===a)throw i;return x()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=k(o,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=c(e,t,n);if("normal"===u.type){if(r=n.done?p:f,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(e,n,o),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d="suspendedStart",f="suspendedYield",h="executing",p="completed",m={};function b(){}function v(){}function w(){}var y={};u(y,i,(function(){return this}));var g=Object.getPrototypeOf,E=g&&g(g(M([])));E&&E!==n&&r.call(E,i)&&(y=E);var _=w.prototype=b.prototype=Object.create(y);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(a,i,o,s){var u=c(e[a],e,i);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(d).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var a;this._invoke=function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}}function k(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=c(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function M(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:x}}function x(){return{value:t,done:!0}}return v.prototype=w,u(_,"constructor",w),u(w,"constructor",v),v.displayName=u(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,u(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},T(A.prototype),u(A.prototype,o,(function(){return this})),e.AsyncIterator=A,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new A(l(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(_),u(_,s,"Generator"),u(_,i,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=M,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return s.type="throw",s.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},588:function(e){"use strict";e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDI1NSAyNTU7IiB4bWw6c3BhY2U9InByZXNlcnZlIiBmaWxsPSIjZmZmZmZmIj4KPGc+Cgk8Y2lyY2xlIGN4PSIxMiIgY3k9IjYiIHI9IjIiLz4KCTxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjIiLz4KCTxjaXJjbGUgY3g9IjEyIiBjeT0iMTgiIHI9IjIiLz4KPC9nPgo8L3N2Zz4K"},400:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZmZmZmZmIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik02IDE5aDRWNUg2djE0em04LTE0djE0aDRWNWgtNHoiLz4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zdmc+Cg=="},735:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZmZmZmZmIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik04IDV2MTRsMTEtN3oiLz4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zdmc+Cg=="},14:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZmZmZmZmIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KICAgIDxwYXRoIGQ9Ik01IDE2aDN2M2gydi01SDV2MnptMy04SDV2Mmg1VjVIOHYzem02IDExaDJ2LTNoM3YtMmgtNXY1em0yLTExVjVoLTJ2NWg1VjhoLTN6Ii8+Cjwvc3ZnPgo="},195:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZmZmZmZmIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KICAgIDxwYXRoIGQ9Ik03IDE0SDV2NWg1di0ySDd2LTN6bS0yLTRoMlY3aDNWNUg1djV6bTEyIDdoLTN2Mmg1di01aC0ydjN6TTE0IDV2MmgzdjNoMlY1aC01eiIvPgo8L3N2Zz4K"},542:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZmZmZmZmIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0xNi41IDEyYzAtMS43Ny0xLjAyLTMuMjktMi41LTQuMDN2Mi4yMWwyLjQ1IDIuNDVjLjAzLS4yLjA1LS40MS4wNS0uNjN6bTIuNSAwYzAgLjk0LS4yIDEuODItLjU0IDIuNjRsMS41MSAxLjUxQzIwLjYzIDE0LjkxIDIxIDEzLjUgMjEgMTJjMC00LjI4LTIuOTktNy44Ni03LTguNzd2Mi4wNmMyLjg5Ljg2IDUgMy41NCA1IDYuNzF6TTQuMjcgM0wzIDQuMjcgNy43MyA5SDN2Nmg0bDUgNXYtNi43M2w0LjI1IDQuMjVjLS42Ny41Mi0xLjQyLjkzLTIuMjUgMS4xOHYyLjA2YzEuMzgtLjMxIDIuNjMtLjk1IDMuNjktMS44MUwxOS43MyAyMSAyMSAxOS43M2wtOS05TDQuMjcgM3pNMTIgNEw5LjkxIDYuMDkgMTIgOC4xOFY0eiIvPgogICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgo8L3N2Zz4K"},662:function(e){"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZmZmZmZmIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0zIDl2Nmg0bDUgNVY0TDcgOUgzem0xMy41IDNjMC0xLjc3LTEuMDItMy4yOS0yLjUtNC4wM3Y4LjA1YzEuNDgtLjczIDIuNS0yLjI1IDIuNS00LjAyek0xNCAzLjIzdjIuMDZjMi44OS44NiA1IDMuNTQgNSA2Ljcxcy0yLjExIDUuODUtNSA2LjcxdjIuMDZjNC4wMS0uOTEgNy00LjQ5IDctOC43N3MtMi45OS03Ljg2LTctOC43N3oiLz4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zdmc+Cg=="},418:function(e){"use strict";e.exports='\nvar WasmPlayerModuleFactory = (function() {\n  var _scriptDir = typeof document !== \'undefined\' && document.currentScript ? document.currentScript.src : undefined;\n  \n  return (\nfunction(WasmPlayerModuleFactory) {\n  WasmPlayerModuleFactory = WasmPlayerModuleFactory || {};\n\n\nfunction aa(){c.buffer!=g&&h(c.buffer);return ba}function m(){c.buffer!=g&&h(c.buffer);return ca}function p(){c.buffer!=g&&h(c.buffer);return da}function ea(){c.buffer!=g&&h(c.buffer);return fa}var t;t||(t=typeof WasmPlayerModuleFactory !== \'undefined\' ? WasmPlayerModuleFactory : {});var u,v;t.ready=new Promise(function(a,b){u=a;v=b});var w={},x;for(x in t)t.hasOwnProperty(x)&&(w[x]=t[x]);function y(a,b){throw b;}\nvar ha="object"===typeof window,z="function"===typeof importScripts,ia="object"===typeof process&&"object"===typeof process.Qa&&"string"===typeof process.Qa.node,B=t.ENVIRONMENT_IS_PTHREAD||!1,C="";function ja(a){return t.locateFile?t.locateFile(a,C):C+a}var ka;\nif(ha||z)z?C=self.location.href:"undefined"!==typeof document&&document.currentScript&&(C=document.currentScript.src),_scriptDir&&(C=_scriptDir),0!==C.indexOf("blob:")?C=C.substr(0,C.replace(/[?#].*/,"").lastIndexOf("/")+1):C="",z&&(ka=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)});var la=t.print||console.log.bind(console),D=t.printErr||console.warn.bind(console);for(x in w)w.hasOwnProperty(x)&&(t[x]=w[x]);w=null;\nt.quit&&(y=t.quit);var E,ma=[],F,G;t.wasmBinary&&(G=t.wasmBinary);var noExitRuntime=t.noExitRuntime||!0;"object"!==typeof WebAssembly&&H("no native wasm support detected");var c,na,I=!1,J;function oa(a){var b=new TextDecoder(a);this.decode=function(d){d.buffer instanceof SharedArrayBuffer&&(d=new Uint8Array(d));return b.decode.call(b,d)}}var pa="undefined"!==typeof TextDecoder?new oa("utf8"):void 0;\nfunction qa(a,b,d){b>>>=0;var e=b+d;for(d=b;a[d>>>0]&&!(d>=e);)++d;if(16<d-b&&a.subarray&&pa)return pa.decode(a.subarray(b>>>0,d>>>0));for(e="";b<d;){var f=a[b++>>>0];if(f&128){var k=a[b++>>>0]&63;if(192==(f&224))e+=String.fromCharCode((f&31)<<6|k);else{var n=a[b++>>>0]&63;f=224==(f&240)?(f&15)<<12|k<<6|n:(f&7)<<18|k<<12|n<<6|a[b++>>>0]&63;65536>f?e+=String.fromCharCode(f):(f-=65536,e+=String.fromCharCode(55296|f>>10,56320|f&1023))}}else e+=String.fromCharCode(f)}return e}\nfunction K(a){return(a>>>=0)?qa(m(),a,void 0):""}"undefined"!==typeof TextDecoder&&new oa("utf-16le");var g,ba,ca,da,fa;B&&(g=t.buffer);function h(a){g=a;t.HEAP8=ba=new Int8Array(a);t.HEAP16=new Int16Array(a);t.HEAP32=da=new Int32Array(a);t.HEAPU8=ca=new Uint8Array(a);t.HEAPU16=new Uint16Array(a);t.HEAPU32=new Uint32Array(a);t.HEAPF32=new Float32Array(a);t.HEAPF64=fa=new Float64Array(a)}var ra=t.INITIAL_MEMORY||167772160;\nif(B)c=t.wasmMemory,g=t.buffer;else if(t.wasmMemory)c=t.wasmMemory;else if(c=new WebAssembly.Memory({initial:ra/65536,maximum:65536,shared:!0}),!(c.buffer instanceof SharedArrayBuffer))throw D("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),ia&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),\nError("bad memory");c&&(g=c.buffer);ra=g.byteLength;h(g);var L,sa=[],ta=[],ua=[],va=[],wa=!1,xa=0;function M(){return noExitRuntime||0<xa}function ya(){var a=t.preRun.shift();sa.unshift(a)}var N=0,za=null,O=null;t.preloadedImages={};t.preloadedAudios={};function H(a){if(B)postMessage({cmd:"onAbort",arg:a});else if(t.onAbort)t.onAbort(a);a="Aborted("+a+")";D(a);I=!0;J=1;a=new WebAssembly.RuntimeError(a+". Build with -s ASSERTIONS=1 for more info.");v(a);throw a;}\nfunction Aa(){return P.startsWith("data:application/octet-stream;base64,")}var Ba=0;function Ca(a){return function(){if(I)throw"program has already aborted!";try{return a.apply(null,arguments)}catch(b){if(I||1<Ba||"longjmp"===b)throw b;H("unhandled exception: "+[b,b.stack])}}}function Da(){var a=L.get,b={};L.get=function(d){var e=a.call(L,d),f=b[d];f&&f.Aa===e||(f=b[d]={Aa:e,Ra:Ca(e)});return f.Ra}}var P;P="libwpengn-simd.wasm";Aa()||(P=ja(P));\nfunction Ea(){var a=P;try{if(a==P&&G)return new Uint8Array(G);if(ka)return ka(a);throw"both async and sync fetching of the wasm failed";}catch(b){H(b)}}function Fa(){return G||!ha&&!z||"function"!==typeof fetch?Promise.resolve().then(function(){return Ea()}):fetch(P,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at \'"+P+"\'";return a.arrayBuffer()}).catch(function(){return Ea()})}var Ga={};\nfunction Q(a){for(;0<a.length;){var b=a.shift();if("function"==typeof b)b(t);else{var d=b.Aa;"number"===typeof d?void 0===b.pa?R(d)():R(d)(b.pa):d(void 0===b.pa?null:b.pa)}}}function Ha(a){var b=Ia();a=a();Ja(b);return a}\nfunction Ka(a,b){if(0>=a||a>aa().length||a&1||0>b)return-28;if(0==b)return 0;2147483647<=b&&(b=Infinity);var d=Atomics.load(p(),S>>2),e=0;if(d==a&&Atomics.compareExchange(p(),S>>2,d,0)==d&&(--b,e=1,0>=b))return 1;a=Atomics.notify(p(),a>>2,b);if(0<=a)return a+e;throw"Atomics.notify returned an unexpected value "+a;}t._emscripten_futex_wake=Ka;function La(a){var b=T.ma[a];b&&(p()[a>>2>>>0]=0,T.ua(b.worker))}function Ma(a){U(a)}t._exit=Ma;function V(a){a instanceof Na||"unwind"==a||y(1,a)}\nvar T={na:[],ra:[],za:[],Ya:function(){},Ia:function(){T.receiveObjectTransfer=T.La;T.threadInit=T.Da;T.setExitStatus=T.Na},ma:{},Na:function(a){J=a},xa:function(){for(var a in T.ma){var b=T.ma[a];b&&b.worker&&T.ua(b.worker)}for(a=0;a<T.na.length;++a)T.na[a].terminate();T.na=[]},ua:function(a){T.Ma(function(){delete T.ma[a.oa.ya];T.na.push(a);T.ra.splice(T.ra.indexOf(a),1);Oa(a.oa.ya);a.oa=void 0})},Ma:function(a){p()[Pa>>>2]=0;try{a()}finally{p()[Pa>>>2]=1}},La:function(){},Da:function(){for(var a in T.za)T.za[a]()},\nJa:function(a,b){a.onmessage=function(d){d=d.data;var e=d.cmd;a.oa&&(T.Fa=a.oa.ya);if(d.targetThread&&d.targetThread!=W()){var f=T.ma[d.bb];f?f.worker.postMessage(d,d.transferList):D(\'Internal error! Worker sent a message "\'+e+\'" to target pthread \'+d.targetThread+", but that thread no longer exists!")}else if("processQueuedMainThreadWork"===e)Qa();else if("spawnThread"===e)Ra(d);else if("cleanupThread"===e)La(d.thread);else if("killThread"===e)d=d.thread,p()[d>>2>>>0]=0,e=T.ma[d],delete T.ma[d],\ne.worker.terminate(),Oa(d),T.ra.splice(T.ra.indexOf(e.worker),1),e.worker.oa=void 0;else if("cancelThread"===e)T.ma[d.thread].worker.postMessage({cmd:"cancel"});else if("loaded"===e)a.loaded=!0,b&&b(a),a.qa&&(a.qa(),delete a.qa);else if("print"===e)la("Thread "+d.threadId+": "+d.text);else if("printErr"===e)D("Thread "+d.threadId+": "+d.text);else if("alert"===e)alert("Thread "+d.threadId+": "+d.text);else if("detachedExit"===e)T.ua(a);else if("cancelDone"===e)T.ua(a);else if("setimmediate"===d.target)a.postMessage(d);\nelse if("onAbort"===e){if(t.onAbort)t.onAbort(d.arg)}else D("worker sent an unknown command "+e);T.Fa=void 0};a.onerror=function(d){D("pthread sent an error! "+d.filename+":"+d.lineno+": "+d.message);throw d;};a.postMessage({cmd:"load",urlOrBlob:t.mainScriptUrlOrBlob||_scriptDir,wasmMemory:c,wasmModule:na})},Ea:function(){var a=ja("libwpengn-simd.worker.js");T.na.push(new Worker(a))},Ha:function(){0==T.na.length&&(T.Ea(),T.Ja(T.na[0]));return T.na.pop()}};\nt.establishStackSpace=function(){var a=W(),b=p()[a+44>>2>>>0];a=p()[a+48>>2>>>0];Sa(b,b-a);Ja(b)};function Ta(a){if(B)return X(1,0,a);try{U(a)}catch(b){V(b)}}var Y=[];function R(a){var b=Y[a];b||(a>=Y.length&&(Y.length=a+1),Y[a]=b=L.get(a));return b}t.invokeEntryPoint=function(a,b){return R(a)(b)};var Ua;Ua=B?function(){return performance.now()-t.__performance_now_clock_drift}:function(){return performance.now()};\nfunction Ra(a){var b=T.Ha();if(!b)return 6;T.ra.push(b);var d=T.ma[a.wa]={worker:b,ya:a.wa};b.oa=d;var e={cmd:"run",start_routine:a.Oa,arg:a.pa,threadInfoStruct:a.wa};b.qa=function(){e.time=performance.now();b.postMessage(e,a.Pa)};b.loaded&&(b.qa(),delete b.qa);return 0}var Va=[null,[],[]],Wa={};function Xa(a,b,d){return B?X(2,1,a,b,d):0}function Ya(a,b,d){return B?X(3,1,a,b,d):0}function Za(a,b,d){if(B)return X(4,1,a,b,d)}\nfunction X(a,b){var d=arguments.length-2,e=arguments;return Ha(function(){for(var f=$a(8*d),k=f>>3,n=0;n<d;n++){var l=e[2+n];ea()[k+n>>>0]=l}return ab(a,d,f,b)})}var bb=[];\nfunction cb(a,b,d,e){Ha(function(){var f=$a(12),k=0;if(b){for(var n=k=0;n<b.length;++n){var l=b.charCodeAt(n);55296<=l&&57343>=l&&(l=65536+((l&1023)<<10)|b.charCodeAt(++n)&1023);127>=l?++k:k=2047>=l?k+2:65535>=l?k+3:k+4}var r=k+1;k=db(r);n=m();l=k>>>0;if(0<r){r=l+r-1;for(var A=0;A<b.length;++A){var q=b.charCodeAt(A);if(55296<=q&&57343>=q){var sb=b.charCodeAt(++A);q=65536+((q&1023)<<10)|sb&1023}if(127>=q){if(l>=r)break;n[l++>>>0]=q}else{if(2047>=q){if(l+1>=r)break;n[l++>>>0]=192|q>>6}else{if(65535>=\nq){if(l+2>=r)break;n[l++>>>0]=224|q>>12}else{if(l+3>=r)break;n[l++>>>0]=240|q>>18;n[l++>>>0]=128|q>>12&63}n[l++>>>0]=128|q>>6&63}n[l++>>>0]=128|q&63}}n[l>>>0]=0}}p()[f>>2>>>0]=k;p()[f+4>>2>>>0]=d;p()[f+8>>2>>>0]=e;eb(0,a,657457152,0,k,f)})}var fb=[0,"undefined"!==typeof document?document:0,"undefined"!==typeof window?window:0];function gb(a){a=2<a?K(a):a;return fb[a]||("undefined"!==typeof document?document.querySelector(a):void 0)}\nfunction hb(a,b,d){var e=gb(a);if(!e)return-4;e.ta&&(p()[e.ta>>2>>>0]=b,p()[e.ta+4>>2>>>0]=d);if(e.Ca||!e.Ta)e.Ca&&(e=e.Ca),a=!1,e.sa&&e.sa.va&&(a=e.sa.va.getParameter(2978),a=0===a[0]&&0===a[1]&&a[2]===e.width&&a[3]===e.height),e.width=b,e.height=d,a&&e.sa.va.viewport(0,0,b,d);else return e.ta?(e=p()[e.ta+8>>2>>>0],a=a?K(a):"",cb(e,a,b,d),1):-4;return 0}function ib(a,b,d){return B?X(5,1,a,b,d):hb(a,b,d)}function jb(a){if(!wa&&!I)try{if(a(),B&&!M())try{B?kb(J):U(J)}catch(b){V(b)}}catch(b){V(b)}}\nfunction lb(a,b){a.Ba||(a.Ba=a.getContext,a.getContext=function(e,f){f=a.Ba(e,f);return"webgl"==e==f instanceof WebGLRenderingContext?f:null});var d=a.getContext("webgl",b);return d?mb(d,b):0}function mb(a,b){var d=db(8);p()[d+4>>2>>>0]=W();b={Xa:d,attributes:b,version:b.Ka,va:a};a.canvas&&(a.canvas.sa=b);return d}var nb=["default","low-power","high-performance"];function ob(a){return B?X(6,1,a):0}function pb(a,b,d,e){if(B)return X(7,1,a,b,d,e);a=Wa.Wa(a);b=Wa.Ua(a,b,d);p()[e>>2>>>0]=b;return 0}\nfunction qb(a,b,d,e,f){if(B)return X(8,1,a,b,d,e,f)}function rb(a,b,d,e){if(B)return X(9,1,a,b,d,e);for(var f=0,k=0;k<d;k++){var n=p()[b>>2>>>0],l=p()[b+4>>2>>>0];b+=8;for(var r=0;r<l;r++){var A=m()[n+r>>>0],q=Va[a];0===A||10===A?((1===a?la:D)(qa(q,0)),q.length=0):q.push(A)}f+=l}p()[e>>2>>>0]=f;return 0}\nvar tb=[null,Ta,Xa,Ya,Za,ib,ob,pb,qb,rb],xb={b:function(a,b,d,e){H("Assertion failed: "+K(a)+", at: "+[b?K(b):"unknown filename",d,e?K(e):"unknown function"])},y:function(a){ub(a,!z,1);T.Da()},u:function(a){B?postMessage({cmd:"cleanupThread",thread:a}):La(a)},k:function(a,b,d,e){if("undefined"===typeof SharedArrayBuffer)return D("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var f=[];if(B&&0===f.length)return vb(687865856,a,b,d,e);a={Oa:d,wa:a,pa:e,Pa:f};\nreturn B?(a.Sa="spawnThread",postMessage(a,f),0):Ra(a)},x:function(){postMessage({cmd:"detachedExit"})},h:Xa,s:Ya,t:Za,D:function(){return 2097152},m:function(a,b){if(a==b)postMessage({cmd:"processQueuedMainThreadWork"});else if(B)postMessage({targetThread:a,cmd:"processThreadQueue"});else{a=(a=T.ma[a])&&a.worker;if(!a)return;a.postMessage({cmd:"processThreadQueue"})}return 1},q:function(){H("")},E:function(a,b){if(0===a)a=Date.now();else if(1===a||4===a)a=Ua();else return p()[wb()>>2>>>0]=28,-1;\np()[b>>2>>>0]=a/1E3|0;p()[b+4>>2>>>0]=a%1E3*1E6|0;return 0},l:function(){z||(E||(E={}),E["Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread"]||(E["Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread"]=1,D("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")))},\nf:function(){},d:function(a,b,d){if(0>=a||a>aa().length||a&1)return-28;if(ha){if(Atomics.load(p(),a>>2)!=b)return-6;var e=performance.now();d=e+d;for(Atomics.exchange(p(),S>>2,a);;){e=performance.now();if(e>d)return Atomics.exchange(p(),S>>2,0),-73;e=Atomics.exchange(p(),S>>2,0);if(0==e)break;Qa();if(Atomics.load(p(),a>>2)!=b)return-6;Atomics.exchange(p(),S>>2,a)}return 0}a=Atomics.wait(p(),a>>2,b,d);if("timed-out"===a)return-73;if("not-equal"===a)return-6;if("ok"===a)return 0;throw"Atomics.wait returned an unexpected value "+\na;},c:Ka,e:Ua,o:function(a,b,d){m().copyWithin(a>>>0,b>>>0,b+d>>>0)},A:function(a,b,d){bb.length=b;d>>=3;for(var e=0;e<b;e++)bb[e]=ea()[d+e>>>0];return(0>a?Ga[-a-1]:tb[a]).apply(null,bb)},p:function(a){var b=m().length;a>>>=0;if(a<=b||4294901760<a)return!1;for(var d=1;4>=d;d*=2){var e=b*(1+.2/d);e=Math.min(e,a+100663296);e=Math.max(a,e);0<e%65536&&(e+=65536-e%65536);a:{try{c.grow(Math.min(4294901760,e)-g.byteLength+65535>>>16);h(c.buffer);var f=1;break a}catch(k){}f=void 0}if(f)return!0}return!1},\nB:function(a,b,d){return gb(a)?hb(a,b,d):ib(a,b,d)},g:function(){},z:function(a,b,d){xa+=1;return setTimeout(function(){--xa;jb(function(){R(a)(d)})},b)},v:function(){throw"unwind";},C:function(a,b){b>>=2;var d=p()[b+6>>>0];b={alpha:!!p()[b>>>0],depth:!!p()[b+1>>>0],stencil:!!p()[b+2>>>0],antialias:!!p()[b+3>>>0],premultipliedAlpha:!!p()[b+4>>>0],preserveDrawingBuffer:!!p()[b+5>>>0],powerPreference:nb[d],failIfMajorPerformanceCaveat:!!p()[b+7>>>0],Ka:p()[b+8>>>0],Za:p()[b+9>>>0],Va:p()[b+10>>>0],\nGa:p()[b+11>>>0],$a:p()[b+12>>>0],ab:p()[b+13>>>0]};a=gb(a);return!a||b.Ga?0:lb(a,b)},w:Ma,j:ob,r:pb,n:qb,i:rb,a:c||t.wasmMemory};\n(function(){function a(f,k){f=f.exports;var n={},l;for(l in f){var r=f[l];n[l]="function"===typeof r?Ca(r):r}t.asm=n;T.za.push(t.asm.$);L=t.asm.W;ta.unshift(t.asm.F);Da();na=k;B||(N--,t.monitorRunDependencies&&t.monitorRunDependencies(N),0==N&&(null!==za&&(clearInterval(za),za=null),O&&(k=O,O=null,k())))}function b(f){a(f.instance,f.module)}function d(f){return Fa().then(function(k){return WebAssembly.instantiate(k,e)}).then(function(k){return k}).then(f,function(k){D("failed to asynchronously prepare wasm: "+\nk);H(k)})}var e={a:xb};B||(N++,t.monitorRunDependencies&&t.monitorRunDependencies(N));if(t.instantiateWasm)try{return t.instantiateWasm(e,a)}catch(f){return D("Module.instantiateWasm callback failed with error: "+f),!1}(function(){return G||"function"!==typeof WebAssembly.instantiateStreaming||Aa()||"function"!==typeof fetch?d(b):fetch(P,{credentials:"same-origin"}).then(function(f){return WebAssembly.instantiateStreaming(f,e).then(b,function(k){D("wasm streaming compile failed: "+k);D("falling back to ArrayBuffer instantiation");\nreturn d(b)})})})().catch(v);return{}})();t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.F).apply(null,arguments)};t._bbpInit=function(){return(t._bbpInit=t.asm.G).apply(null,arguments)};t._bbpUninit=function(){return(t._bbpUninit=t.asm.H).apply(null,arguments)};t._bbpOpen=function(){return(t._bbpOpen=t.asm.I).apply(null,arguments)};t._bbpMainProc=function(){return(t._bbpMainProc=t.asm.J).apply(null,arguments)};\nt._bbpFillBuff=function(){return(t._bbpFillBuff=t.asm.K).apply(null,arguments)};t._bbpSeek=function(){return(t._bbpSeek=t.asm.L).apply(null,arguments)};t._bbpPlay=function(){return(t._bbpPlay=t.asm.M).apply(null,arguments)};t._bbpPause=function(){return(t._bbpPause=t.asm.N).apply(null,arguments)};t._bbpSpeed=function(){return(t._bbpSpeed=t.asm.O).apply(null,arguments)};t._bbpAudio=function(){return(t._bbpAudio=t.asm.P).apply(null,arguments)};\nt._bbpRemoveBuff=function(){return(t._bbpRemoveBuff=t.asm.Q).apply(null,arguments)};t._bbpRange=function(){return(t._bbpRange=t.asm.R).apply(null,arguments)};t._bbpFlush=function(){return(t._bbpFlush=t.asm.S).apply(null,arguments)};t._bbpQuality=function(){return(t._bbpQuality=t.asm.T).apply(null,arguments)};t._bbpSetSuspend=function(){return(t._bbpSetSuspend=t.asm.U).apply(null,arguments)};t._main=function(){return(t._main=t.asm.V).apply(null,arguments)};\nvar db=t._malloc=function(){return(db=t._malloc=t.asm.X).apply(null,arguments)};t._free=function(){return(t._free=t.asm.Y).apply(null,arguments)};var W=t._pthread_self=function(){return(W=t._pthread_self=t.asm.Z).apply(null,arguments)},wb=t.___errno_location=function(){return(wb=t.___errno_location=t.asm._).apply(null,arguments)};t._emscripten_tls_init=function(){return(t._emscripten_tls_init=t.asm.$).apply(null,arguments)};\nt._emscripten_current_thread_process_queued_calls=function(){return(t._emscripten_current_thread_process_queued_calls=t.asm.aa).apply(null,arguments)};\nvar vb=t._emscripten_sync_run_in_main_thread_4=function(){return(vb=t._emscripten_sync_run_in_main_thread_4=t.asm.ba).apply(null,arguments)},Qa=t._emscripten_main_thread_process_queued_calls=function(){return(Qa=t._emscripten_main_thread_process_queued_calls=t.asm.ca).apply(null,arguments)},ab=t._emscripten_run_in_main_runtime_thread_js=function(){return(ab=t._emscripten_run_in_main_runtime_thread_js=t.asm.da).apply(null,arguments)},eb=t.__emscripten_call_on_thread=function(){return(eb=t.__emscripten_call_on_thread=\nt.asm.ea).apply(null,arguments)},Oa=t.__emscripten_thread_free_data=function(){return(Oa=t.__emscripten_thread_free_data=t.asm.fa).apply(null,arguments)},kb=t.__emscripten_thread_exit=function(){return(kb=t.__emscripten_thread_exit=t.asm.ga).apply(null,arguments)},ub=t.__emscripten_thread_init=function(){return(ub=t.__emscripten_thread_init=t.asm.ha).apply(null,arguments)},Ia=t.stackSave=function(){return(Ia=t.stackSave=t.asm.ia).apply(null,arguments)},Ja=t.stackRestore=function(){return(Ja=t.stackRestore=\nt.asm.ja).apply(null,arguments)},$a=t.stackAlloc=function(){return($a=t.stackAlloc=t.asm.ka).apply(null,arguments)},Sa=t._emscripten_stack_set_limits=function(){return(Sa=t._emscripten_stack_set_limits=t.asm.la).apply(null,arguments)},Pa=t.__emscripten_allow_main_runtime_queued_calls=87584,S=t.__emscripten_main_thread_futex=119448;\nt.addFunction=function(a,b){if(!F){F=new WeakMap;for(var d=L.length,e=0;e<0+d;e++){var f=R(e);f&&F.set(f,e)}}if(F.has(a))return F.get(a);if(ma.length)d=ma.pop();else{try{L.grow(1)}catch(l){if(!(l instanceof RangeError))throw l;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.";}d=L.length-1}try{e=d,L.set(e,a),Y[e]=a}catch(l){if(!(l instanceof TypeError))throw l;if("function"===typeof WebAssembly.Function){f={i:"i32",j:"i64",f:"f32",d:"f64"};var k={parameters:[],results:"v"==b[0]?[]:[f[b[0]]]};\nfor(e=1;e<b.length;++e)k.parameters.push(f[b[e]]);e=new WebAssembly.Function(k,a)}else{f=[1,0,1,96];k=b.slice(0,1);b=b.slice(1);var n={i:127,j:126,f:125,d:124};f.push(b.length);for(e=0;e<b.length;++e)f.push(n[b[e]]);"v"==k?f.push(0):f=f.concat([1,n[k]]);f[1]=f.length-2;b=new Uint8Array([0,97,115,109,1,0,0,0].concat(f,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0]));b=new WebAssembly.Module(b);e=(new WebAssembly.Instance(b,{e:{f:a}})).exports.f}b=d;L.set(b,e);Y[b]=e}F.set(a,d);return d};\nt.keepRuntimeAlive=M;t.PThread=T;t.PThread=T;t.wasmMemory=c;t.ExitStatus=Na;var Z;function Na(a){this.name="ExitStatus";this.message="Program terminated with exit("+a+")";this.status=a}O=function yb(){Z||zb();Z||(O=yb)};\nfunction zb(){function a(){if(!Z&&(Z=!0,t.calledRun=!0,!I)){B||Q(ta);B||Q(ua);u(t);if(t.onRuntimeInitialized)t.onRuntimeInitialized();if(Ab){var b=t._main;try{Ba+=2;var d=b(0,0);U(d,!0)}catch(e){V(e)}finally{Ba-=2}}if(!B){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)b=t.postRun.shift(),va.unshift(b);Q(va)}}}if(!(0<N))if(B)u(t),B||Q(ta),postMessage({cmd:"loaded"});else{if(!B){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)ya();\nQ(sa)}0<N||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1);a()},1)):a())}}t.run=zb;function U(a,b){J=a;if(!b&&B)throw Ta(a),"unwind";M()||B||(T.xa(),wa=!0);J=a;if(!M()){T.xa();if(t.onExit)t.onExit(a);I=!0}y(a,new Na(a))}if(t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();var Ab=!0;t.noInitialRun&&(Ab=!1);B&&(noExitRuntime=!1,T.Ia());zb();t.terminateAllThreads=T.xa;\n\n\n  return WasmPlayerModuleFactory.ready\n}\n);\n})();\nif (typeof exports === \'object\' && typeof module === \'object\')\n  module.exports = WasmPlayerModuleFactory;\nelse if (typeof define === \'function\' && define[\'amd\'])\n  define([], function() { return WasmPlayerModuleFactory; });\nelse if (typeof exports === \'object\')\n  exports["WasmPlayerModuleFactory"] = WasmPlayerModuleFactory;\n'},903:function(e){"use strict";e.exports='\nvar WasmPlayerModuleFactory = (function() {\n  var _scriptDir = typeof document !== \'undefined\' && document.currentScript ? document.currentScript.src : undefined;\n  \n  return (\nfunction(WasmPlayerModuleFactory) {\n  WasmPlayerModuleFactory = WasmPlayerModuleFactory || {};\n\n\nfunction aa(){c.buffer!=g&&h(c.buffer);return ba}function m(){c.buffer!=g&&h(c.buffer);return ca}function p(){c.buffer!=g&&h(c.buffer);return da}function ea(){c.buffer!=g&&h(c.buffer);return fa}var t;t||(t=typeof WasmPlayerModuleFactory !== \'undefined\' ? WasmPlayerModuleFactory : {});var u,v;t.ready=new Promise(function(a,b){u=a;v=b});var w={},x;for(x in t)t.hasOwnProperty(x)&&(w[x]=t[x]);function y(a,b){throw b;}\nvar ha="object"===typeof window,z="function"===typeof importScripts,ia="object"===typeof process&&"object"===typeof process.Qa&&"string"===typeof process.Qa.node,B=t.ENVIRONMENT_IS_PTHREAD||!1,C="";function ja(a){return t.locateFile?t.locateFile(a,C):C+a}var ka;\nif(ha||z)z?C=self.location.href:"undefined"!==typeof document&&document.currentScript&&(C=document.currentScript.src),_scriptDir&&(C=_scriptDir),0!==C.indexOf("blob:")?C=C.substr(0,C.replace(/[?#].*/,"").lastIndexOf("/")+1):C="",z&&(ka=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)});var la=t.print||console.log.bind(console),D=t.printErr||console.warn.bind(console);for(x in w)w.hasOwnProperty(x)&&(t[x]=w[x]);w=null;\nt.quit&&(y=t.quit);var E,ma=[],F,G;t.wasmBinary&&(G=t.wasmBinary);var noExitRuntime=t.noExitRuntime||!0;"object"!==typeof WebAssembly&&H("no native wasm support detected");var c,na,I=!1,J;function oa(a){var b=new TextDecoder(a);this.decode=function(d){d.buffer instanceof SharedArrayBuffer&&(d=new Uint8Array(d));return b.decode.call(b,d)}}var pa="undefined"!==typeof TextDecoder?new oa("utf8"):void 0;\nfunction qa(a,b,d){b>>>=0;var e=b+d;for(d=b;a[d>>>0]&&!(d>=e);)++d;if(16<d-b&&a.subarray&&pa)return pa.decode(a.subarray(b>>>0,d>>>0));for(e="";b<d;){var f=a[b++>>>0];if(f&128){var k=a[b++>>>0]&63;if(192==(f&224))e+=String.fromCharCode((f&31)<<6|k);else{var n=a[b++>>>0]&63;f=224==(f&240)?(f&15)<<12|k<<6|n:(f&7)<<18|k<<12|n<<6|a[b++>>>0]&63;65536>f?e+=String.fromCharCode(f):(f-=65536,e+=String.fromCharCode(55296|f>>10,56320|f&1023))}}else e+=String.fromCharCode(f)}return e}\nfunction K(a){return(a>>>=0)?qa(m(),a,void 0):""}"undefined"!==typeof TextDecoder&&new oa("utf-16le");var g,ba,ca,da,fa;B&&(g=t.buffer);function h(a){g=a;t.HEAP8=ba=new Int8Array(a);t.HEAP16=new Int16Array(a);t.HEAP32=da=new Int32Array(a);t.HEAPU8=ca=new Uint8Array(a);t.HEAPU16=new Uint16Array(a);t.HEAPU32=new Uint32Array(a);t.HEAPF32=new Float32Array(a);t.HEAPF64=fa=new Float64Array(a)}var ra=t.INITIAL_MEMORY||167772160;\nif(B)c=t.wasmMemory,g=t.buffer;else if(t.wasmMemory)c=t.wasmMemory;else if(c=new WebAssembly.Memory({initial:ra/65536,maximum:65536,shared:!0}),!(c.buffer instanceof SharedArrayBuffer))throw D("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),ia&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),\nError("bad memory");c&&(g=c.buffer);ra=g.byteLength;h(g);var L,sa=[],ta=[],ua=[],va=[],wa=!1,xa=0;function M(){return noExitRuntime||0<xa}function ya(){var a=t.preRun.shift();sa.unshift(a)}var N=0,za=null,O=null;t.preloadedImages={};t.preloadedAudios={};function H(a){if(B)postMessage({cmd:"onAbort",arg:a});else if(t.onAbort)t.onAbort(a);a="Aborted("+a+")";D(a);I=!0;J=1;a=new WebAssembly.RuntimeError(a+". Build with -s ASSERTIONS=1 for more info.");v(a);throw a;}\nfunction Aa(){return P.startsWith("data:application/octet-stream;base64,")}var Ba=0;function Ca(a){return function(){if(I)throw"program has already aborted!";try{return a.apply(null,arguments)}catch(b){if(I||1<Ba||"longjmp"===b)throw b;H("unhandled exception: "+[b,b.stack])}}}function Da(){var a=L.get,b={};L.get=function(d){var e=a.call(L,d),f=b[d];f&&f.Aa===e||(f=b[d]={Aa:e,Ra:Ca(e)});return f.Ra}}var P;P="libwpengn.wasm";Aa()||(P=ja(P));\nfunction Ea(){var a=P;try{if(a==P&&G)return new Uint8Array(G);if(ka)return ka(a);throw"both async and sync fetching of the wasm failed";}catch(b){H(b)}}function Fa(){return G||!ha&&!z||"function"!==typeof fetch?Promise.resolve().then(function(){return Ea()}):fetch(P,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at \'"+P+"\'";return a.arrayBuffer()}).catch(function(){return Ea()})}var Ga={};\nfunction Q(a){for(;0<a.length;){var b=a.shift();if("function"==typeof b)b(t);else{var d=b.Aa;"number"===typeof d?void 0===b.pa?R(d)():R(d)(b.pa):d(void 0===b.pa?null:b.pa)}}}function Ha(a){var b=Ia();a=a();Ja(b);return a}\nfunction Ka(a,b){if(0>=a||a>aa().length||a&1||0>b)return-28;if(0==b)return 0;2147483647<=b&&(b=Infinity);var d=Atomics.load(p(),S>>2),e=0;if(d==a&&Atomics.compareExchange(p(),S>>2,d,0)==d&&(--b,e=1,0>=b))return 1;a=Atomics.notify(p(),a>>2,b);if(0<=a)return a+e;throw"Atomics.notify returned an unexpected value "+a;}t._emscripten_futex_wake=Ka;function La(a){var b=T.ma[a];b&&(p()[a>>2>>>0]=0,T.ua(b.worker))}function Ma(a){U(a)}t._exit=Ma;function V(a){a instanceof Na||"unwind"==a||y(1,a)}\nvar T={na:[],ra:[],za:[],Ya:function(){},Ia:function(){T.receiveObjectTransfer=T.La;T.threadInit=T.Da;T.setExitStatus=T.Na},ma:{},Na:function(a){J=a},xa:function(){for(var a in T.ma){var b=T.ma[a];b&&b.worker&&T.ua(b.worker)}for(a=0;a<T.na.length;++a)T.na[a].terminate();T.na=[]},ua:function(a){T.Ma(function(){delete T.ma[a.oa.ya];T.na.push(a);T.ra.splice(T.ra.indexOf(a),1);Oa(a.oa.ya);a.oa=void 0})},Ma:function(a){p()[Pa>>>2]=0;try{a()}finally{p()[Pa>>>2]=1}},La:function(){},Da:function(){for(var a in T.za)T.za[a]()},\nJa:function(a,b){a.onmessage=function(d){d=d.data;var e=d.cmd;a.oa&&(T.Fa=a.oa.ya);if(d.targetThread&&d.targetThread!=W()){var f=T.ma[d.bb];f?f.worker.postMessage(d,d.transferList):D(\'Internal error! Worker sent a message "\'+e+\'" to target pthread \'+d.targetThread+", but that thread no longer exists!")}else if("processQueuedMainThreadWork"===e)Qa();else if("spawnThread"===e)Ra(d);else if("cleanupThread"===e)La(d.thread);else if("killThread"===e)d=d.thread,p()[d>>2>>>0]=0,e=T.ma[d],delete T.ma[d],\ne.worker.terminate(),Oa(d),T.ra.splice(T.ra.indexOf(e.worker),1),e.worker.oa=void 0;else if("cancelThread"===e)T.ma[d.thread].worker.postMessage({cmd:"cancel"});else if("loaded"===e)a.loaded=!0,b&&b(a),a.qa&&(a.qa(),delete a.qa);else if("print"===e)la("Thread "+d.threadId+": "+d.text);else if("printErr"===e)D("Thread "+d.threadId+": "+d.text);else if("alert"===e)alert("Thread "+d.threadId+": "+d.text);else if("detachedExit"===e)T.ua(a);else if("cancelDone"===e)T.ua(a);else if("setimmediate"===d.target)a.postMessage(d);\nelse if("onAbort"===e){if(t.onAbort)t.onAbort(d.arg)}else D("worker sent an unknown command "+e);T.Fa=void 0};a.onerror=function(d){D("pthread sent an error! "+d.filename+":"+d.lineno+": "+d.message);throw d;};a.postMessage({cmd:"load",urlOrBlob:t.mainScriptUrlOrBlob||_scriptDir,wasmMemory:c,wasmModule:na})},Ea:function(){var a=ja("libwpengn.worker.js");T.na.push(new Worker(a))},Ha:function(){0==T.na.length&&(T.Ea(),T.Ja(T.na[0]));return T.na.pop()}};\nt.establishStackSpace=function(){var a=W(),b=p()[a+44>>2>>>0];a=p()[a+48>>2>>>0];Sa(b,b-a);Ja(b)};function Ta(a){if(B)return X(1,0,a);try{U(a)}catch(b){V(b)}}var Y=[];function R(a){var b=Y[a];b||(a>=Y.length&&(Y.length=a+1),Y[a]=b=L.get(a));return b}t.invokeEntryPoint=function(a,b){return R(a)(b)};var Ua;Ua=B?function(){return performance.now()-t.__performance_now_clock_drift}:function(){return performance.now()};\nfunction Ra(a){var b=T.Ha();if(!b)return 6;T.ra.push(b);var d=T.ma[a.wa]={worker:b,ya:a.wa};b.oa=d;var e={cmd:"run",start_routine:a.Oa,arg:a.pa,threadInfoStruct:a.wa};b.qa=function(){e.time=performance.now();b.postMessage(e,a.Pa)};b.loaded&&(b.qa(),delete b.qa);return 0}var Va=[null,[],[]],Wa={};function Xa(a,b,d){return B?X(2,1,a,b,d):0}function Ya(a,b,d){return B?X(3,1,a,b,d):0}function Za(a,b,d){if(B)return X(4,1,a,b,d)}\nfunction X(a,b){var d=arguments.length-2,e=arguments;return Ha(function(){for(var f=$a(8*d),k=f>>3,n=0;n<d;n++){var l=e[2+n];ea()[k+n>>>0]=l}return ab(a,d,f,b)})}var bb=[];\nfunction cb(a,b,d,e){Ha(function(){var f=$a(12),k=0;if(b){for(var n=k=0;n<b.length;++n){var l=b.charCodeAt(n);55296<=l&&57343>=l&&(l=65536+((l&1023)<<10)|b.charCodeAt(++n)&1023);127>=l?++k:k=2047>=l?k+2:65535>=l?k+3:k+4}var r=k+1;k=db(r);n=m();l=k>>>0;if(0<r){r=l+r-1;for(var A=0;A<b.length;++A){var q=b.charCodeAt(A);if(55296<=q&&57343>=q){var sb=b.charCodeAt(++A);q=65536+((q&1023)<<10)|sb&1023}if(127>=q){if(l>=r)break;n[l++>>>0]=q}else{if(2047>=q){if(l+1>=r)break;n[l++>>>0]=192|q>>6}else{if(65535>=\nq){if(l+2>=r)break;n[l++>>>0]=224|q>>12}else{if(l+3>=r)break;n[l++>>>0]=240|q>>18;n[l++>>>0]=128|q>>12&63}n[l++>>>0]=128|q>>6&63}n[l++>>>0]=128|q&63}}n[l>>>0]=0}}p()[f>>2>>>0]=k;p()[f+4>>2>>>0]=d;p()[f+8>>2>>>0]=e;eb(0,a,657457152,0,k,f)})}var fb=[0,"undefined"!==typeof document?document:0,"undefined"!==typeof window?window:0];function gb(a){a=2<a?K(a):a;return fb[a]||("undefined"!==typeof document?document.querySelector(a):void 0)}\nfunction hb(a,b,d){var e=gb(a);if(!e)return-4;e.ta&&(p()[e.ta>>2>>>0]=b,p()[e.ta+4>>2>>>0]=d);if(e.Ca||!e.Ta)e.Ca&&(e=e.Ca),a=!1,e.sa&&e.sa.va&&(a=e.sa.va.getParameter(2978),a=0===a[0]&&0===a[1]&&a[2]===e.width&&a[3]===e.height),e.width=b,e.height=d,a&&e.sa.va.viewport(0,0,b,d);else return e.ta?(e=p()[e.ta+8>>2>>>0],a=a?K(a):"",cb(e,a,b,d),1):-4;return 0}function ib(a,b,d){return B?X(5,1,a,b,d):hb(a,b,d)}function jb(a){if(!wa&&!I)try{if(a(),B&&!M())try{B?kb(J):U(J)}catch(b){V(b)}}catch(b){V(b)}}\nfunction lb(a,b){a.Ba||(a.Ba=a.getContext,a.getContext=function(e,f){f=a.Ba(e,f);return"webgl"==e==f instanceof WebGLRenderingContext?f:null});var d=a.getContext("webgl",b);return d?mb(d,b):0}function mb(a,b){var d=db(8);p()[d+4>>2>>>0]=W();b={Xa:d,attributes:b,version:b.Ka,va:a};a.canvas&&(a.canvas.sa=b);return d}var nb=["default","low-power","high-performance"];function ob(a){return B?X(6,1,a):0}function pb(a,b,d,e){if(B)return X(7,1,a,b,d,e);a=Wa.Wa(a);b=Wa.Ua(a,b,d);p()[e>>2>>>0]=b;return 0}\nfunction qb(a,b,d,e,f){if(B)return X(8,1,a,b,d,e,f)}function rb(a,b,d,e){if(B)return X(9,1,a,b,d,e);for(var f=0,k=0;k<d;k++){var n=p()[b>>2>>>0],l=p()[b+4>>2>>>0];b+=8;for(var r=0;r<l;r++){var A=m()[n+r>>>0],q=Va[a];0===A||10===A?((1===a?la:D)(qa(q,0)),q.length=0):q.push(A)}f+=l}p()[e>>2>>>0]=f;return 0}\nvar tb=[null,Ta,Xa,Ya,Za,ib,ob,pb,qb,rb],xb={b:function(a,b,d,e){H("Assertion failed: "+K(a)+", at: "+[b?K(b):"unknown filename",d,e?K(e):"unknown function"])},y:function(a){ub(a,!z,1);T.Da()},u:function(a){B?postMessage({cmd:"cleanupThread",thread:a}):La(a)},k:function(a,b,d,e){if("undefined"===typeof SharedArrayBuffer)return D("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var f=[];if(B&&0===f.length)return vb(687865856,a,b,d,e);a={Oa:d,wa:a,pa:e,Pa:f};\nreturn B?(a.Sa="spawnThread",postMessage(a,f),0):Ra(a)},x:function(){postMessage({cmd:"detachedExit"})},h:Xa,s:Ya,t:Za,D:function(){return 2097152},m:function(a,b){if(a==b)postMessage({cmd:"processQueuedMainThreadWork"});else if(B)postMessage({targetThread:a,cmd:"processThreadQueue"});else{a=(a=T.ma[a])&&a.worker;if(!a)return;a.postMessage({cmd:"processThreadQueue"})}return 1},q:function(){H("")},E:function(a,b){if(0===a)a=Date.now();else if(1===a||4===a)a=Ua();else return p()[wb()>>2>>>0]=28,-1;\np()[b>>2>>>0]=a/1E3|0;p()[b+4>>2>>>0]=a%1E3*1E6|0;return 0},l:function(){z||(E||(E={}),E["Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread"]||(E["Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread"]=1,D("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")))},\nf:function(){},d:function(a,b,d){if(0>=a||a>aa().length||a&1)return-28;if(ha){if(Atomics.load(p(),a>>2)!=b)return-6;var e=performance.now();d=e+d;for(Atomics.exchange(p(),S>>2,a);;){e=performance.now();if(e>d)return Atomics.exchange(p(),S>>2,0),-73;e=Atomics.exchange(p(),S>>2,0);if(0==e)break;Qa();if(Atomics.load(p(),a>>2)!=b)return-6;Atomics.exchange(p(),S>>2,a)}return 0}a=Atomics.wait(p(),a>>2,b,d);if("timed-out"===a)return-73;if("not-equal"===a)return-6;if("ok"===a)return 0;throw"Atomics.wait returned an unexpected value "+\na;},c:Ka,e:Ua,o:function(a,b,d){m().copyWithin(a>>>0,b>>>0,b+d>>>0)},A:function(a,b,d){bb.length=b;d>>=3;for(var e=0;e<b;e++)bb[e]=ea()[d+e>>>0];return(0>a?Ga[-a-1]:tb[a]).apply(null,bb)},p:function(a){var b=m().length;a>>>=0;if(a<=b||4294901760<a)return!1;for(var d=1;4>=d;d*=2){var e=b*(1+.2/d);e=Math.min(e,a+100663296);e=Math.max(a,e);0<e%65536&&(e+=65536-e%65536);a:{try{c.grow(Math.min(4294901760,e)-g.byteLength+65535>>>16);h(c.buffer);var f=1;break a}catch(k){}f=void 0}if(f)return!0}return!1},\nB:function(a,b,d){return gb(a)?hb(a,b,d):ib(a,b,d)},g:function(){},z:function(a,b,d){xa+=1;return setTimeout(function(){--xa;jb(function(){R(a)(d)})},b)},v:function(){throw"unwind";},C:function(a,b){b>>=2;var d=p()[b+6>>>0];b={alpha:!!p()[b>>>0],depth:!!p()[b+1>>>0],stencil:!!p()[b+2>>>0],antialias:!!p()[b+3>>>0],premultipliedAlpha:!!p()[b+4>>>0],preserveDrawingBuffer:!!p()[b+5>>>0],powerPreference:nb[d],failIfMajorPerformanceCaveat:!!p()[b+7>>>0],Ka:p()[b+8>>>0],Za:p()[b+9>>>0],Va:p()[b+10>>>0],\nGa:p()[b+11>>>0],$a:p()[b+12>>>0],ab:p()[b+13>>>0]};a=gb(a);return!a||b.Ga?0:lb(a,b)},w:Ma,j:ob,r:pb,n:qb,i:rb,a:c||t.wasmMemory};\n(function(){function a(f,k){f=f.exports;var n={},l;for(l in f){var r=f[l];n[l]="function"===typeof r?Ca(r):r}t.asm=n;T.za.push(t.asm.$);L=t.asm.W;ta.unshift(t.asm.F);Da();na=k;B||(N--,t.monitorRunDependencies&&t.monitorRunDependencies(N),0==N&&(null!==za&&(clearInterval(za),za=null),O&&(k=O,O=null,k())))}function b(f){a(f.instance,f.module)}function d(f){return Fa().then(function(k){return WebAssembly.instantiate(k,e)}).then(function(k){return k}).then(f,function(k){D("failed to asynchronously prepare wasm: "+\nk);H(k)})}var e={a:xb};B||(N++,t.monitorRunDependencies&&t.monitorRunDependencies(N));if(t.instantiateWasm)try{return t.instantiateWasm(e,a)}catch(f){return D("Module.instantiateWasm callback failed with error: "+f),!1}(function(){return G||"function"!==typeof WebAssembly.instantiateStreaming||Aa()||"function"!==typeof fetch?d(b):fetch(P,{credentials:"same-origin"}).then(function(f){return WebAssembly.instantiateStreaming(f,e).then(b,function(k){D("wasm streaming compile failed: "+k);D("falling back to ArrayBuffer instantiation");\nreturn d(b)})})})().catch(v);return{}})();t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.F).apply(null,arguments)};t._bbpInit=function(){return(t._bbpInit=t.asm.G).apply(null,arguments)};t._bbpUninit=function(){return(t._bbpUninit=t.asm.H).apply(null,arguments)};t._bbpOpen=function(){return(t._bbpOpen=t.asm.I).apply(null,arguments)};t._bbpMainProc=function(){return(t._bbpMainProc=t.asm.J).apply(null,arguments)};\nt._bbpFillBuff=function(){return(t._bbpFillBuff=t.asm.K).apply(null,arguments)};t._bbpSeek=function(){return(t._bbpSeek=t.asm.L).apply(null,arguments)};t._bbpPlay=function(){return(t._bbpPlay=t.asm.M).apply(null,arguments)};t._bbpPause=function(){return(t._bbpPause=t.asm.N).apply(null,arguments)};t._bbpSpeed=function(){return(t._bbpSpeed=t.asm.O).apply(null,arguments)};t._bbpAudio=function(){return(t._bbpAudio=t.asm.P).apply(null,arguments)};\nt._bbpRemoveBuff=function(){return(t._bbpRemoveBuff=t.asm.Q).apply(null,arguments)};t._bbpRange=function(){return(t._bbpRange=t.asm.R).apply(null,arguments)};t._bbpFlush=function(){return(t._bbpFlush=t.asm.S).apply(null,arguments)};t._bbpQuality=function(){return(t._bbpQuality=t.asm.T).apply(null,arguments)};t._bbpSetSuspend=function(){return(t._bbpSetSuspend=t.asm.U).apply(null,arguments)};t._main=function(){return(t._main=t.asm.V).apply(null,arguments)};\nvar db=t._malloc=function(){return(db=t._malloc=t.asm.X).apply(null,arguments)};t._free=function(){return(t._free=t.asm.Y).apply(null,arguments)};var W=t._pthread_self=function(){return(W=t._pthread_self=t.asm.Z).apply(null,arguments)},wb=t.___errno_location=function(){return(wb=t.___errno_location=t.asm._).apply(null,arguments)};t._emscripten_tls_init=function(){return(t._emscripten_tls_init=t.asm.$).apply(null,arguments)};\nt._emscripten_current_thread_process_queued_calls=function(){return(t._emscripten_current_thread_process_queued_calls=t.asm.aa).apply(null,arguments)};\nvar vb=t._emscripten_sync_run_in_main_thread_4=function(){return(vb=t._emscripten_sync_run_in_main_thread_4=t.asm.ba).apply(null,arguments)},Qa=t._emscripten_main_thread_process_queued_calls=function(){return(Qa=t._emscripten_main_thread_process_queued_calls=t.asm.ca).apply(null,arguments)},ab=t._emscripten_run_in_main_runtime_thread_js=function(){return(ab=t._emscripten_run_in_main_runtime_thread_js=t.asm.da).apply(null,arguments)},eb=t.__emscripten_call_on_thread=function(){return(eb=t.__emscripten_call_on_thread=\nt.asm.ea).apply(null,arguments)},Oa=t.__emscripten_thread_free_data=function(){return(Oa=t.__emscripten_thread_free_data=t.asm.fa).apply(null,arguments)},kb=t.__emscripten_thread_exit=function(){return(kb=t.__emscripten_thread_exit=t.asm.ga).apply(null,arguments)},ub=t.__emscripten_thread_init=function(){return(ub=t.__emscripten_thread_init=t.asm.ha).apply(null,arguments)},Ia=t.stackSave=function(){return(Ia=t.stackSave=t.asm.ia).apply(null,arguments)},Ja=t.stackRestore=function(){return(Ja=t.stackRestore=\nt.asm.ja).apply(null,arguments)},$a=t.stackAlloc=function(){return($a=t.stackAlloc=t.asm.ka).apply(null,arguments)},Sa=t._emscripten_stack_set_limits=function(){return(Sa=t._emscripten_stack_set_limits=t.asm.la).apply(null,arguments)},Pa=t.__emscripten_allow_main_runtime_queued_calls=79744,S=t.__emscripten_main_thread_futex=111608;\nt.addFunction=function(a,b){if(!F){F=new WeakMap;for(var d=L.length,e=0;e<0+d;e++){var f=R(e);f&&F.set(f,e)}}if(F.has(a))return F.get(a);if(ma.length)d=ma.pop();else{try{L.grow(1)}catch(l){if(!(l instanceof RangeError))throw l;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.";}d=L.length-1}try{e=d,L.set(e,a),Y[e]=a}catch(l){if(!(l instanceof TypeError))throw l;if("function"===typeof WebAssembly.Function){f={i:"i32",j:"i64",f:"f32",d:"f64"};var k={parameters:[],results:"v"==b[0]?[]:[f[b[0]]]};\nfor(e=1;e<b.length;++e)k.parameters.push(f[b[e]]);e=new WebAssembly.Function(k,a)}else{f=[1,0,1,96];k=b.slice(0,1);b=b.slice(1);var n={i:127,j:126,f:125,d:124};f.push(b.length);for(e=0;e<b.length;++e)f.push(n[b[e]]);"v"==k?f.push(0):f=f.concat([1,n[k]]);f[1]=f.length-2;b=new Uint8Array([0,97,115,109,1,0,0,0].concat(f,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0]));b=new WebAssembly.Module(b);e=(new WebAssembly.Instance(b,{e:{f:a}})).exports.f}b=d;L.set(b,e);Y[b]=e}F.set(a,d);return d};\nt.keepRuntimeAlive=M;t.PThread=T;t.PThread=T;t.wasmMemory=c;t.ExitStatus=Na;var Z;function Na(a){this.name="ExitStatus";this.message="Program terminated with exit("+a+")";this.status=a}O=function yb(){Z||zb();Z||(O=yb)};\nfunction zb(){function a(){if(!Z&&(Z=!0,t.calledRun=!0,!I)){B||Q(ta);B||Q(ua);u(t);if(t.onRuntimeInitialized)t.onRuntimeInitialized();if(Ab){var b=t._main;try{Ba+=2;var d=b(0,0);U(d,!0)}catch(e){V(e)}finally{Ba-=2}}if(!B){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)b=t.postRun.shift(),va.unshift(b);Q(va)}}}if(!(0<N))if(B)u(t),B||Q(ta),postMessage({cmd:"loaded"});else{if(!B){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)ya();\nQ(sa)}0<N||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1);a()},1)):a())}}t.run=zb;function U(a,b){J=a;if(!b&&B)throw Ta(a),"unwind";M()||B||(T.xa(),wa=!0);J=a;if(!M()){T.xa();if(t.onExit)t.onExit(a);I=!0}y(a,new Na(a))}if(t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();var Ab=!0;t.noInitialRun&&(Ab=!1);B&&(noExitRuntime=!1,T.Ia());zb();t.terminateAllThreads=T.xa;\n\n\n  return WasmPlayerModuleFactory.ready\n}\n);\n})();\nif (typeof exports === \'object\' && typeof module === \'object\')\n  module.exports = WasmPlayerModuleFactory;\nelse if (typeof define === \'function\' && define[\'amd\'])\n  define([], function() { return WasmPlayerModuleFactory; });\nelse if (typeof exports === \'object\')\n  exports["WasmPlayerModuleFactory"] = WasmPlayerModuleFactory;\n'},333:function(e){"use strict";e.exports='"use strict";var Module={};function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=function(info,receiveInstance){var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onmessage=function(e){try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob==="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmPlayerModuleFactory(Module).then(function(instance){Module=instance})}else if(e.data.cmd==="run"){Module["__performance_now_clock_drift"]=performance.now()-e.data.time;Module["__emscripten_thread_init"](e.data.threadInfoStruct,/*isMainBrowserThread=*/0,/*isMainRuntimeThread=*/0);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInit();try{var result=Module["invokeEntryPoint"](e.data.start_routine,e.data.arg);if(Module["keepRuntimeAlive"]()){Module["PThread"].setExitStatus(result)}else{Module["__emscripten_thread_exit"](result)}}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}/*PTHREAD_CANCELED*/postMessage({"cmd":"cancelDone"})}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processThreadQueue"){if(Module["_pthread_self"]()){Module["_emscripten_current_thread_process_queued_calls"]()}}else{err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){err("worker.js onmessage() captured an uncaught exception: "+ex);if(ex&&ex.stack)err(ex.stack);throw ex}};\n'},658:function(e){"use strict";e.exports='!function(){class s extends AudioWorkletProcessor{constructor(s){super(s),this.playState=!1,this.offset=0,this.audioBuffer=[],this.port.onmessage=this.onmessage.bind(this)}flush(){this.audioBuffer.length=0,this.offset=0}seek(s,e){if(-1===e)this.flush();else{this.offset=0;let s=0;for(s=0;s<this.audioBuffer.length&&!(this.audioBuffer[s].time>=e);s++);this.audioBuffer.splice(0,s)}if(this.postMessage("SEEKED",{seekFlag:s}),-1!==e){let s=0;this.audioBuffer.length>0&&(s=this.audioBuffer[0].time-this.audioBuffer[this.audioBuffer.length-1].time),this.postMessage("TIME_UPDATE",{currentTime:-1,bufferTime:s})}}postMessage(s,e){this.port.postMessage({message:s,options:e})}onmessage(s){const{data:e}=s;if(!e)return;const t=e?.message,i=e?.buffer;"APPEND_BUFFER"===t?i?this.audioBuffer.push(i):this.postMessage("ERROR",{detail:"[BwpProcessor] must valid buffer"}):"PLAY"===t?this.playState=!0:"PAUSE"===t?this.playState=!1:"FLUSH"===t?this.flush():"SEEK"===t&&this.seek(e?.seekFlag,e?.pos)}process(s,e,t){const i=this.audioBuffer[0],f=e[0][0],o=e[0][1];if(!f||f&&!f.length)return this.postMessage("ERROR",{detail:"[BwpProcessor] must have left channel"}),!1;if(!o||o&&!o.length)return this.postMessage("ERROR",{detail:"[BwpProcessor] must have right channel"}),!1;if(!i||!this.playState){for(let s=0;s<f.length;s++)f[s]=0,o[s]=0;return!0}const h=i.channels,r=new Float32Array(i.data.buffer);for(let s=0;s<f.length;s++)2===h?(f[s]=r[2*s+this.offset],o[s]=r[2*s+1+this.offset]):(f[s]=r[s+this.offset],o[s]=r[s+this.offset]);if(0===this.offset){const s=this.audioBuffer[this.audioBuffer.length-1].time-i.time;this.postMessage("TIME_UPDATE",{currentTime:i.time,bufferTime:s})}return this.offset+=f.length*h,this.offset>=r.length&&(this.offset=0,this.audioBuffer.shift()),!0}}registerProcessor("bwp-processor",s)}();'}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.b=document.baseURI||self.location.href;var r={};return function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}n.d(r,{default:function(){return Er}});var t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]);function a(){try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(t)}catch(e){return!1}}var i=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);function o(){try{return WebAssembly.validate(i)}catch(e){return!1}}function s(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video/mp4",r=document.createElement("video");if("function"!=typeof r.canPlayType||"function"!=typeof(null===(t=window.MediaSource)||void 0===t?void 0:t.isTypeSupported))return!1;var a="".concat(n,'; codecs="').concat(e,'"'),i=r.canPlayType(a).toLowerCase();return!("maybe"!==i&&"probably"!==i||!window.MediaSource.isTypeSupported(a))}function u(){var e,t,n=document.createElement("canvas"),r="",a="";try{(e=n.getContext("webgl")||n.getContext("webgl2")||n.getContext("experimental-webgl"))&&(t=e.getExtension("WEBGL_debug_renderer_info"))&&(r=e.getParameter(t.UNMASKED_VENDOR_WEBGL),a=e.getParameter(t.UNMASKED_RENDERER_WEBGL))}catch(e){return null}return{vendor:r,renderer:a}}var l="name",c="version";function d(t,n){for(var r,a,i,o,s,u={},l=0;l<n.length;l+=2){r=n[l],i=n[l+1];for(var c=0;c<r.length;c++)if(s=r[c].exec(t)){for(var d=0;d<i.length;d++)o=s[d+1],"object"===e(a=i[d])&&a.length>0?2===a.length?u[a[0]]=a[1]:console.error("[Browser] [rgxMapper] not support arg count!"):u[a]=o||void 0;return u}}return u}var f=function(){var e="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:null,t="other",n="other",r="0";if(null!==e){t=function(e){var t=d(e,[[/microsoft (windows) (vista|xp)/i],"",[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[/ ]?([\d.\w ]*)/i,/(windows)[/ ]?([ntce\d. ]+\w)(?!.+xbox)/i],[l],[/(win(?=3|9|n)|win 9x )([nt\d.]+)/i],"Windows",[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[l,"iOS"]],[/(mac os x) ?([\w. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,"Mac OS"]]]).name;return{Windows:!0,"Mac OS":!0}[t]?t:"other"}(e);var i=function(e){var t=d(e,[[/edg(?:e|ios|a)?\/([\w.]+)/i],[c,[l,"Edge"]],[/\bopr\/([\w.]+)/i],[c,[l,"Opera"]],[/(kindle)\/([\w.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[/ ]?([\w.]*)/i,/(avant |iemobile|slim)(?:browser)?[/ ]?([\w.]*)/i,/(ba?idubrowser)[/ ]?([\w.]+)/i,/(?:ms|\()(ie) ([\w.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w.]+)/i,/(weibo)__([\d.]+)/i],[l,c],[/(?:\buc? ?browser|(?:juc.+)ucweb)[/ ]?([\w.]+)/i],[c,[l,"UCBrowser"]],[/\bqbcore\/([\w.]+)/i],[c,[l,"WeChat(Win) Desktop"]],[/micromessenger\/([\w.]+)/i],[c,[l,"WeChat"]],[/konqueror\/([\w.]+)/i],[c,[l,"Konqueror"]],[/trident.+rv[: ]([\w.]{1,9})\b.+like gecko/i],[c,[l,"IE"]],[/yabrowser\/([\w.]+)/i],[c,[l,"Yandex"]],[/(avast|avg)\/([\w.]+)/i],[[l,"Avast/AVG Secure Browser"],c],[/coc_coc\w+\/([\w.]+)/i],[c,[l,"Coc Coc"]],[/dolfin\/([\w.]+)/i],[c,[l,"Dolphin"]],[/slbrowser\/([\w.]+)/i],[c,[l,"Lenovo"]],[/115browser\/([\w.]+)/i],[c,[l,"115 Browser"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[l,"360 Browser"]],[/(comodo_dragon)\/([\w.]+)/i],[[l,"Comodo Dragon"],c],[/(electron)\/([\w.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[/ ]?([\w.]+)/i],[l,c],[/(metasr)[/ ]?([\w.]+)/i,/(lbbrowser)/i],[l],[/headlesschrome(?:\/([\w.]+)| )/i],[c,[l,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w.]+)/i],[[l,"Chrome WebView"],c],[/(chrome)\/v?([\w.]+)/i],[[l,"Chrome"],c]]);return{browser:{Chrome:!0,Edge:!0}[t.name]?t.name:"other",version:t.version||"0"}}(e);n=i.browser,r=i.version}return{ua:e||"",os:t,browser:n,version:r,gpuInfo:u(),hardwareConcurrency:window.navigator.hardwareConcurrency||0,isSIMDSupported:o(),isPThreadSupported:a(),isSupportHEVC:s("hvc1.1.6.L123")}};function h(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,a)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){h(i,r,a,o,s,"next",e)}function s(e){h(i,r,a,o,s,"throw",e)}o(void 0)}))}}var m=n(757),b=n.n(m);function v(){return(v=p(b().mark((function e(t,n,r){var a,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(r,{credentials:"same-origin"});case 2:if((a=e.sent).ok){e.next=5;break}throw new Error("failed to load wasm file from network");case 5:return e.next=7,a.arrayBuffer();case 7:return i=e.sent,e.next=10,t.put(n,i);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,n,r){return y.apply(this,arguments)}function y(){return(y=p(b().mark((function e(t,n,r,a){var i,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(a,{credentials:"same-origin"});case 2:if((i=e.sent).ok){e.next=5;break}throw new Error("failed to load wasm file from network");case 5:return e.next=7,i.arrayBuffer();case 7:return o=e.sent,e.next=10,t.put(n,o);case 10:return e.next=12,WebAssembly.instantiate(o,r);case 12:return s=e.sent,e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=p(b().mark((function e(t,n,r,a){var i,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.get(n);case 3:if(o=e.sent){e.next=6;break}throw new Error("get wasm from indexedDB failed");case 6:return e.next=8,WebAssembly.instantiate(o,r);case 8:case 16:i=e.sent,e.next=20;break;case 11:if(e.prev=11,e.t0=e.catch(0),!a){e.next=19;break}return e.next=16,w(t,n,r,a);case 19:throw e.t0;case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=function(){var e={};return"undefined"!=typeof window&&(e=window),"undefined"!=typeof self&&(e=self),e},R=function(){function e(t,n){E(this,e),A(this,"dbName",void 0),A(this,"storeName",void 0),A(this,"dbPromise",void 0),this.dbName=t,this.storeName=n,this.initDB()}var t,n,r,a,i;return T(e,[{key:"initDB",value:function(e){var t=this;if(!k().indexedDB)throw new Error("Not support indexedDB!");var n=indexedDB.open(this.dbName,e);this.dbPromise=new Promise((function(e,r){n.onsuccess=function(){e(n.result)},n.onupgradeneeded=function(){n.result.objectStoreNames.contains(t.storeName)||n.result.createObjectStore(t.storeName)},n.onerror=function(e){r(e)}}))}},{key:"getObjectStore",value:(i=p(b().mark((function e(t){var n,r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dbPromise;case 2:return n=e.sent,r=n.transaction(this.storeName,t),e.abrupt("return",r.objectStore(this.storeName));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"get",value:(a=p(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readonly");case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){var a=n.get(t);a.onsuccess=function(){e(a.result)},a.onerror=r})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"put",value:(r=p(b().mark((function e(t,n){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return r=e.sent,e.abrupt("return",new Promise((function(e,a){var i=r.put(n,t);i.onsuccess=function(){e(i.result)},i.onerror=a})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"delete",value:(n=p(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return n=e.sent,e.abrupt("return",n.delete(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"clear",value:(t=p(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return t=e.sent,e.abrupt("return",t.clear());case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"isSupported",value:function(){return!!k().indexedDB}}]),e}(),S=R;function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var x=!1,C="4.7.3",I="https://s1.hdslb.com/bfs/static/wasmplayer/libwpengn-4.7.3.wasm",L="https://s1.hdslb.com/bfs/static/wasmplayer/libwpengn-simd-4.7.3.wasm";var B,D="1"===window.localStorage.getItem("bwphevc_debug")||x;!function(e){e.TRACE="trace",e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(B||(B={}));var N=function(){function e(){E(this,e)}return T(e,[{key:"proxyLog",value:function(e,t){var n;D&&(n=console)[e].apply(n,M(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.proxyLog(B.INFO,t)}},{key:"trace",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.proxyLog(B.TRACE,t)}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.proxyLog(B.DEBUG,t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.proxyLog(B.WARN,t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.proxyLog(B.ERROR,t)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();A(N,"instance",void 0);var O=N,W={BROWSER_LIST:{Chrome:{min:80,blackList:[]},Edge:{min:80,blackList:[]}},OS_LIST:{Windows:!0,"Mac OS":!0},GPU_LIST:[],BASE_CPU_CORE_NUMBER:4},U="[Browser]",F=O.getInstance(),j=navigator.userAgent,H="bwphevc_live_supported",G=!1,V=!1,Y=null,z={browser:!1,browserHEVC:!1,cpu:!1,gpu:!1,gpuInfo:null,simd:!1,pthread:!1,hardwareConcurrency:0};function K(e){var t=JSON.stringify({version:C,ua:j,supported:e,supportInfo:z,cached:G,date:+new Date});localStorage.setItem(H,t)}function q(e){V=!0,setTimeout((function(){var t=I;t=z.simd?L:I,function(e,t,n){return v.apply(this,arguments)}(new S("bwphevc-live","lib"),"libwpengn.wasm",t).then((function(){F.log(U,"Cache done!"),V=!1,G=!0,K(!0),e(!0)})).catch((function(){V=!1,e(!1)}))}),0)}function X(){if(null!==Y)return Y;var e,t,n,r,a,i,o,s,u,l=JSON.parse(localStorage.getItem(H)||"null"),c=(null==l?void 0:l.version)===C;if(!(l&&c&&l.ua===j)){G=Boolean(l&&l.cached&&c);var d=(e=+new Date,t=f(),n=W.BROWSER_LIST[t.browser],r=!!W.OS_LIST[t.os]&&!!n&&parseFloat("".concat(t.version))>=n.min,a=!!t.gpuInfo,i=t.hardwareConcurrency>=W.BASE_CPU_CORE_NUMBER,o=t.isPThreadSupported,s=t.isSupportHEVC,u=!(!(o&&i&&a&&r)||s&&"Edge"!==t.browser),F.warn(U,"supportedChecker end spent: ".concat(+new Date-e,"ms, pass: ").concat(u)),{pass:u,supportInfo:{browser:r,browserHEVC:s,cpu:i,gpu:a,gpuInfo:t.gpuInfo,simd:t.isSIMDSupported,pthread:o,hardwareConcurrency:t.hardwareConcurrency}});z=d.supportInfo,K(Y=d.pass)}else null!=l&&l.supported?(Y=!0,z=(null==l?void 0:l.supportInfo)||z,null!=l&&l.cached?(F.log(U,"SUPPORT! Already cached!"),G=!0):(F.log(U,"SUPPORT! But not cache done!"),G=!1)):Y=!1;return Boolean(Y)}function Z(e){V?e(!1):X()?G?e(!0):q(e):e(!1)}function Q(){return z}var J=T((function e(){E(this,e)}));A(J,"WASM_PLAYER_ERROR",7e3),A(J,"CORE_PLAYER_LOAD_ERROR",7001),A(J,"CORE_PLAYER_MODULE_LOAD_TIMEOUT",7002),A(J,"CORE_PLAYER_EXCEPTION",7003),A(J,"WASM_MEMORY_MALLOC_ERROR",7004),A(J,"CORE_PLAYER_ADD_FUNCTION_ERROR",7005),A(J,"SAMPLE_RATE_NOT_SUPPORTED",7006),A(J,"AUDIO_RENDER_ERROR",7007),A(J,"AUDIO_CHANNELS_NOT_SUPPORT",7008),A(J,"OUT_OF_SYNC",7013);var $,ee,te,ne,re,ae,ie,oe=J;function se(e,t){return se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},se(e,t)}function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&se(e,t)}function ce(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return ue(t)}function de(e){return de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},de(e)}function fe(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function he(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,fe(e,t,"get"))}function pe(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,fe(e,t,"set"),n),n}!function(e){e.CLOSED="closed",e.OPEN="open",e.ENDED="ended"}($||($={})),function(e){e.NETWORK="network",e.DECODE="decode"}(ee||(ee={})),function(e){e[e.NETWORK_EMPTY=0]="NETWORK_EMPTY",e[e.NETWORK_IDLE=1]="NETWORK_IDLE",e[e.NETWORK_LOADING=2]="NETWORK_LOADING",e[e.NETWORK_NO_SOURCE=3]="NETWORK_NO_SOURCE"}(te||(te={})),function(e){e[e.HAVE_NOTHING=0]="HAVE_NOTHING",e[e.HAVE_METADATA=1]="HAVE_METADATA",e[e.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",e[e.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",e[e.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA"}(ne||(ne={})),function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(re||(re={})),function(e){e.SEGMENTS="segments",e.SEQUENCE="sequence"}(ae||(ae={})),function(e){e.AUDIO="audio",e.VIDEO="video",e.MIX="mix"}(ie||(ie={}));var me=T((function e(){E(this,e)})),be=window.EventTarget||me;function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}var we,ye=function(e){le(n,e);var t=ve(n);function n(){var e;return E(this,n),A(ue(e=t.call(this)),"onaddsourcebuffer",void 0),A(ue(e),"onremovesourcebuffer",void 0),A(ue(e),"sourceBuffers",void 0),e.sourceBuffers=[],ce(e,new Proxy(ue(e),{get:function(e,t,n){return Number.isNaN(Number(t))?"function"==typeof e[t]?e[t].bind(e):Reflect.get(e,t,n):e.sourceBuffers[t]}}))}return T(n,[{key:"length",get:function(){return this.sourceBuffers.length}},{key:"insert",value:function(e,t){this.sourceBuffers.splice(t,0,e)}},{key:"remove",value:function(e){this.sourceBuffers.splice(e,1)}},{key:"push",value:function(e){this.sourceBuffers.push(e)}},{key:"pop",value:function(){return this.sourceBuffers.pop()}},{key:"indexOf",value:function(e){return this.sourceBuffers.indexOf(e)}}]),n}(be),ge=T((function e(){var t;E(this,e),A(this,"fps",void 0),A(this,"creationTime",void 0),A(this,"totalVideoFrames",void 0),A(this,"droppedVideoFrames",void 0),this.fps=0,this.totalVideoFrames=0,this.droppedVideoFrames=0,this.creationTime=+new Date-((null===(t=window.performance)||void 0===t?void 0:t.timing.navigationStart)||0)}));!function(e){e.CANPLAY="canplay",e.INIT_DONE="init_done"}(we||(we={}));var Ee=T((function e(){E(this,e)})),_e=Event;"function"!=typeof Event&&(_e=Ee);var Te=_e,Ae=T((function e(){E(this,e)}));A(Ae,"LOAD_START","loadstart"),A(Ae,"PROGRESS","progress"),A(Ae,"SUSPEND","suspend"),A(Ae,"ABORT","abort"),A(Ae,"ERROR","error"),A(Ae,"EMPTIED","emptied"),A(Ae,"STALLED","stalled"),A(Ae,"LOADED_METADATA","loadedmetadata"),A(Ae,"LOADED_DATA","loadeddata"),A(Ae,"CANPLAY","canplay"),A(Ae,"CANPLAY_THROUGH","canplaythrough"),A(Ae,"PLAYING","playing"),A(Ae,"WAITING","waiting"),A(Ae,"SEEKING","seeking"),A(Ae,"SEEKED","seeked"),A(Ae,"ENDED","ended"),A(Ae,"DURATION_CHANGE","durationchange"),A(Ae,"TIME_UPDATE","timeupdate"),A(Ae,"PLAY","play"),A(Ae,"PAUSE","pause"),A(Ae,"RATE_CHANGE","ratechange"),A(Ae,"RESIZE","resize"),A(Ae,"VOLUME_CHANGE","volumechange"),A(Ae,"CHANGE","change"),A(Ae,"ADD_TRACK","addtrack"),A(Ae,"REMOVE_TRACK","removetrack"),A(Ae,"CUE_CHANGE","cuechange"),A(Ae,"ENTER_PICTURE_IN_PICTURE","enterpictureinpicture"),A(Ae,"LEAVE_PICTURE_IN_PICTURE","leavepictureinpicture"),A(Ae,"PERFORMANCE","performance");var ke=Ae;function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}var Se=function(e){le(n,e);var t=Re(n);function n(e,r,a){var i;return E(this,n),A(ue(i=t.call(this,ke.PERFORMANCE,a)),"errorCode",void 0),A(ue(i),"describe",void 0),i.errorCode=e,i.describe=r,i}return T(n)}(Te);function Pe(e,t){Promise.resolve().then((function(){e.dispatchEvent(new Event(t))}))}var Me=n(658);function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}var Ce=function(e){le(r,e);var t,n=xe(r);function r(e,t){var a;return E(this,r),A(ue(a=n.call(this)),"logger",void 0),A(ue(a),"TAG","[AudioWorkletRender]"),A(ue(a),"DEFAULT_VOLUME",1),A(ue(a),"audioCtx",void 0),A(ue(a),"gainNode",void 0),A(ue(a),"audioBuffer",void 0),A(ue(a),"audioprocessCallback",void 0),A(ue(a),"errorCallback",void 0),A(ue(a),"bwpProcessorUrl",void 0),A(ue(a),"bwpProcessorNode",void 0),A(ue(a),"_volume",void 0),A(ue(a),"playState",void 0),A(ue(a),"seeking",void 0),A(ue(a),"seekFlag",void 0),A(ue(a),"workletInitDone",void 0),A(ue(a),"onmessage",(function(e){var t=e.data;if(t&&a.audioCtx){var n=t.message,r=t.options;if("TIME_UPDATE"===n){var i=r.currentTime,o=r.bufferTime;void 0===i||void 0===o||a.seeking||a.audioprocessCallback&&a.audioprocessCallback(i,o)}else"SEEKED"===n?(null==r?void 0:r.seekFlag)===a.seekFlag&&(a.seeking=!1):"ERROR"===n&&a.errorCallback&&a.errorCallback(oe.AUDIO_RENDER_ERROR,(null==r?void 0:r.detail)||"BwpProcessor unknow error")}})),A(ue(a),"setAutoResume",(function(){for(var e=["keydown","mousedown","touchstart"],t=0;t<e.length;t++)document.addEventListener(e[t],(function(){a.resume()}),{once:!0})})),a.logger=O.getInstance(),a.audioCtx=null,a.gainNode=null,a.audioBuffer=[],a._volume=a.DEFAULT_VOLUME,a.playState=!1,a.seeking=!1,a.workletInitDone=!1,a.audioprocessCallback=e,a.errorCallback=t,a}return T(r,[{key:"volume",get:function(){return this._volume},set:function(e){this.gainNode&&(this.gainNode.gain.value=e,this._volume=e)}},{key:"sampleRate",get:function(){var e;return(null===(e=this.audioCtx)||void 0===e?void 0:e.sampleRate)||0}},{key:"play",value:function(){this.playState=!0,this.postSimpleMessage("PLAY")}},{key:"pause",value:function(){this.playState=!1,this.postSimpleMessage("PAUSE")}},{key:"seek",value:function(e){var t;this.seeking=!0,this.seekFlag=+new Date,null===(t=this.bwpProcessorNode)||void 0===t||t.port.postMessage({message:"SEEK",pos:e,seekFlag:this.seekFlag})}},{key:"canPlay",value:function(){return!(!this.audioCtx||"suspended"===this.audioCtx.state)}},{key:"isPlaying",value:function(){return this.playState}},{key:"isInitDone",value:function(){return this.workletInitDone}},{key:"fillBuffer",value:function(e){var t;null===(t=this.bwpProcessorNode)||void 0===t||t.port.postMessage({message:"APPEND_BUFFER",buffer:e})}},{key:"flushBuffer",value:function(){this.postSimpleMessage("FLUSH")}},{key:"init",value:(t=p(b().mark((function e(t){var n,r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.log(this.TAG,"init audio worklet render with sampleRate: ".concat(t)),n=+new Date,this.audioCtx&&this.destroy(!0),e.prev=3,this.bwpProcessorUrl=URL.createObjectURL(new Blob([Me],{type:"application/javascript"})),this.audioCtx=new(window.AudioContext||window.webkitAudioContext)({sampleRate:t}),a=this.audioCtx,this.gainNode=a.createGain(),this.gainNode.gain.value=this._volume,e.next=11,null==a||null===(r=a.audioWorklet)||void 0===r?void 0:r.addModule(this.bwpProcessorUrl);case 11:if(a&&this.gainNode){e.next=13;break}return e.abrupt("return");case 13:this.bwpProcessorNode=new window.AudioWorkletNode(a,"bwp-processor",{channelCount:2,numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[2]}),this.bwpProcessorNode.port.onmessage=this.onmessage,this.bwpProcessorNode.port.start(),this.bwpProcessorNode.connect(this.gainNode),this.gainNode.connect(a.destination),URL.revokeObjectURL(this.bwpProcessorUrl),this.logger.warn(this.TAG,"init AudioWorkletNode done, ".concat(+new Date-n," ms")),this.workletInitDone=!0,Pe(this,we.INIT_DONE),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(3),this.errorCallback&&this.errorCallback(oe.AUDIO_RENDER_ERROR,(null===e.t0||void 0===e.t0?void 0:e.t0.message)||"BwpProcessor init error");case 27:this.setAutoResume();case 28:case"end":return e.stop()}}),e,this,[[3,24]])}))),function(e){return t.apply(this,arguments)})},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{null!==this.audioCtx&&(this.gainNode&&this.bwpProcessorNode&&(this.flushBuffer(),this.bwpProcessorNode.port.onmessage=null,this.bwpProcessorNode.port.close(),this.bwpProcessorNode.disconnect(this.gainNode),this.gainNode.disconnect(this.audioCtx.destination)),this.audioCtx.close()),this.audioCtx=null,this.gainNode=null,e||(this.audioprocessCallback=null,this.errorCallback=null),this.audioBuffer.length=0,this.playState=!1,this._volume=1,this.seeking=!1,this.seekFlag=0,this.workletInitDone=!1}catch(e){}}},{key:"postSimpleMessage",value:function(e){var t;null===(t=this.bwpProcessorNode)||void 0===t||t.port.postMessage({message:e})}},{key:"resume",value:function(){var e=this;this.audioCtx&&"suspended"===this.audioCtx.state&&this.audioCtx.resume().then((function(){e.triggerCanplay(),e.playState&&e.logger.warn(e.TAG,"Audio is resumed")}))}},{key:"triggerCanplay",value:function(){this.canPlay()&&(this.logger.warn(this.TAG,"audio render [canplay]"),Pe(this,we.CANPLAY))}}]),r}(be),Ie=Ce;function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}var Be=function(e){le(r,e);var t,n=Le(r);function r(e,t){var a;return E(this,r),A(ue(a=n.call(this)),"logger",void 0),A(ue(a),"TAG","[AudioContextRender]"),A(ue(a),"DEFAULT_VOLUME",1),A(ue(a),"audioCtx",void 0),A(ue(a),"gainNode",void 0),A(ue(a),"audioBufferSourceNode",void 0),A(ue(a),"scriptProcessorNode",void 0),A(ue(a),"audioBuffer",void 0),A(ue(a),"audioprocessCallback",void 0),A(ue(a),"errorCallback",void 0),A(ue(a),"_volume",void 0),A(ue(a),"playState",void 0),A(ue(a),"audioprocessHandler",(function(e){if(a.audioCtx&&a.gainNode){var t=e.outputBuffer,n=a.audioBuffer[0];if(n&&a.playState){for(var r=new Float32Array(n.data.buffer),i=0;i<t.numberOfChannels;i++)for(var o=t.getChannelData(i),s=0;s<t.length;s++)o[s]=r[2*s+i];var u=a.audioBuffer[a.audioBuffer.length-1].time-n.time;a.audioprocessCallback&&a.audioprocessCallback(n.time,u),a.audioBuffer.shift()}else for(var l=0;l<t.numberOfChannels;l++)for(var c=t.getChannelData(l),d=0;d<t.length;d++)c[d]=0}else a.errorCallback&&a.errorCallback(oe.AUDIO_RENDER_ERROR,"Audio context and GainNode must be valid!")})),A(ue(a),"setAutoResume",(function(){for(var e=["keydown","mousedown","touchstart"],t=0;t<e.length;t++)document.addEventListener(e[t],(function(){a.resume()}),{once:!0})})),a.logger=O.getInstance(),a.audioCtx=null,a.gainNode=null,a.audioBufferSourceNode=null,a.scriptProcessorNode=null,a.audioBuffer=[],a._volume=a.DEFAULT_VOLUME,a.playState=!1,a.audioprocessCallback=e,a.errorCallback=t,a}return T(r,[{key:"volume",get:function(){return this._volume},set:function(e){this.gainNode&&(this.gainNode.gain.value=e,this._volume=e)}},{key:"sampleRate",get:function(){var e;return(null===(e=this.audioCtx)||void 0===e?void 0:e.sampleRate)||0}},{key:"play",value:function(){this.playState=!0}},{key:"pause",value:function(){this.playState=!1}},{key:"seek",value:function(e){var t=this;if(-1===e)this.flushBuffer();else{var n=0;for(n=0;n<this.audioBuffer.length&&!(this.audioBuffer[n].time>=e);n++);this.audioBuffer.splice(0,n);var r=0;this.audioBuffer.length>0&&this.audioCtx&&(r=this.audioBuffer[this.audioBuffer.length-1].time-this.audioBuffer[0].time),setTimeout((function(){t.audioprocessCallback&&t.audioprocessCallback(-1,r)}),0)}}},{key:"canPlay",value:function(){return!(!this.audioCtx||"suspended"===this.audioCtx.state)}},{key:"isPlaying",value:function(){return this.playState}},{key:"fillBuffer",value:function(e){this.audioBuffer.push(e)}},{key:"isInitDone",value:function(){return null!==this.audioCtx}},{key:"flushBuffer",value:function(){this.audioBuffer.length=0}},{key:"init",value:(t=p(b().mark((function e(t){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.audioCtx&&this.destroy(!0),this.audioCtx=new(window.AudioContext||window.webkitAudioContext)({sampleRate:t}),n=this.audioCtx,this.gainNode=n.createGain(),this.gainNode.gain.value=this._volume,this.audioBufferSourceNode=n.createBufferSource(),this.scriptProcessorNode=n.createScriptProcessor(4096,0,2),this.scriptProcessorNode.addEventListener("audioprocess",this.audioprocessHandler),this.audioBufferSourceNode.connect(this.scriptProcessorNode),this.scriptProcessorNode.connect(this.gainNode),this.gainNode.connect(n.destination),this.audioBufferSourceNode.start(),Pe(this,we.INIT_DONE),this.setAutoResume();case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"destroy",value:function(){var e,t,n,r,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!==this.audioCtx&&(this.audioCtx.close(),this.scriptProcessorNode&&(null===(t=this.audioBufferSourceNode)||void 0===t||t.disconnect(this.scriptProcessorNode)),this.gainNode&&(null===(n=this.scriptProcessorNode)||void 0===n||n.disconnect(this.gainNode)),null===(r=this.gainNode)||void 0===r||r.disconnect(this.audioCtx.destination));this.audioCtx=null,this.gainNode=null,this.audioBufferSourceNode=null,null===(e=this.scriptProcessorNode)||void 0===e||e.removeEventListener("audioprocess",this.audioprocessHandler),this.scriptProcessorNode=null,a||(this.audioprocessCallback=null,this.errorCallback=null),this.audioBuffer.length=0,this._volume=1,this.playState=!1}},{key:"resume",value:function(){var e=this;this.audioCtx&&"suspended"===this.audioCtx.state&&this.audioCtx.resume().then((function(){e.triggerCanplay(),e.playState&&e.logger.warn(e.TAG,"Audio is resumed")}))}},{key:"triggerCanplay",value:function(){this.canPlay()&&(this.logger.warn(this.TAG,"audio render [canplay]"),Pe(this,we.CANPLAY))}}]),r}(be),De=Be;function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}var Oe=function(e){le(n,e);var t=Ne(n);function n(e,r,a){var i;return E(this,n),A(ue(i=t.call(this,e,a)),"currentTime",void 0),i.currentTime=r,i}return T(n)}(Te),We=T((function e(){E(this,e)}));A(We,"BBP_MSG_WASM_LOAD",1),A(We,"BBP_MSG_OPEN_DONE",17),A(We,"BBP_MSG_OPEN_FAIL",18),A(We,"BBP_MSG_SEEK_POS",32),A(We,"BBP_MSG_SEEK_DONE",33),A(We,"BBP_MSG_SEEK_FAIL",34),A(We,"BBP_MSG_PLAY_POS",49),A(We,"BBP_MSG_PLAY_DUR",50),A(We,"BBP_MSG_PLAY_BUF",52),A(We,"BBP_MSG_PLAY_ERROR",65),A(We,"BBP_MSG_PLAY_COMPLETE",66),A(We,"BBP_MSG_PLAY_QULITY",68),A(We,"BBP_MSG_ERROR_DATA",112),A(We,"BBP_STRM_SOURCE",1),A(We,"BBP_LOG_LEVEL_DUMP",5),A(We,"BBP_LOG_LEVEL_DEBUG",4),A(We,"BBP_LOG_LEVEL_INFO",3),A(We,"BBP_LOG_LEVEL_WARNING",2),A(We,"BBP_LOG_LEVEL_ERR",1),A(We,"BBP_LOG_LEVEL_NONE",0),A(We,"BBP_DATA_FLAG_FORMAT",2),A(We,"BBP_MSG_FITST_FRAME",17),A(We,"BBP_SEEK_FILE",16),A(We,"BBP_SEEK_LIVE",32),A(We,"BBP_SEEK_POS",1),A(We,"BBP_SEEK_KEY",2);var Ue=We;function Fe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function je(e,t,n){return je=Fe()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&se(a,n.prototype),a},je.apply(null,arguments)}function He(e){var t="function"==typeof Map?new Map:void 0;return He=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return je(e,arguments,de(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),se(r,e)},He(e)}function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}var Ve=function(e){le(n,e);var t=Ge(n);function n(e,r){var a;return E(this,n),(a=t.call(this,e)).name=r,a.message=e,a.stack=(new Error).stack,a}return T(n)}(He(Error)),Ye=function(e){le(n,e);var t=Ge(n);function n(){return E(this,n),t.call(this,"The operation is not supported.","NotSupportedError")}return T(n)}(Ve),ze=function(e){le(n,e);var t=Ge(n);function n(){return E(this,n),t.call(this,"The object is in an invalid state.","InvalidStateError")}return T(n)}(Ve),Ke=function(e){le(n,e);var t=Ge(n);function n(){return E(this,n),t.call(this,"The index is not in the allowed range.","IndexSizeError")}return T(n)}(Ve);function qe(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var Xe=new WeakMap,Ze=new WeakMap,Qe=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];E(this,e),qe(this,Xe,{writable:!0,value:void 0}),qe(this,Ze,{writable:!0,value:function(e){if(!(null!==e&&!Number.isNaN(e)&&e%1==0))throw new Error("index argument is not an integer");if(e>=he(t,Xe).length||e<0)throw new Ke}}),pe(this,Xe,n)}return T(e,[{key:"length",get:function(){return he(this,Xe).length}},{key:"start",value:function(e){return he(this,Ze).call(this,e),he(this,Xe)[e].start}},{key:"end",value:function(e){return he(this,Ze).call(this,e),he(this,Xe)[e].end}}]),e}(),Je=Qe,$e={alpha:!1,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1,powerPreference:"low-power"},et=function(){function e(t,n){var r=this;if(E(this,e),A(this,"width",void 0),A(this,"height",void 0),A(this,"canvas",void 0),A(this,"gl",void 0),A(this,"texCoordBuffer",void 0),A(this,"textureCoordAttribute",void 0),A(this,"yTexture",void 0),A(this,"uTexture",void 0),A(this,"vTexture",void 0),A(this,"lastFrameData",void 0),A(this,"isContextLost",void 0),A(this,"logger",void 0),A(this,"TAG","[VideoRender]"),A(this,"webglcontextlostHandler",(function(e){e.preventDefault(),r.logger.warn(r.TAG,"webgl context lost"),r.isContextLost=!0})),A(this,"webglcontextrestoredHandler",(function(e){e.preventDefault(),r.logger.warn(r.TAG,"webgl context restored"),r.clear(),r.initGL(),r.isContextLost=!1})),this.canvas=t,this.texCoordBuffer=null,this.gl=this.canvas.getContext("webgl",n||$e),this.isContextLost=!1,!this.gl)throw new Error("[VideoRender] WebGL not supported.");this.logger=O.getInstance(),this.initGL(),this.initEventListener()}return T(e,[{key:"initGL",value:function(){var e=this.gl;e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.pixelStorei(e.UNPACK_ALIGNMENT,1);var t=this.compileShader("\n    attribute mediump vec4 aVertexPosition;\n    attribute vec2 aTextureCoord;\n    varying highp vec2 vTextureCoord;\n    void main() {\n        gl_Position = aVertexPosition;\n        vTextureCoord = aTextureCoord;\n    }\n",e.VERTEX_SHADER),n=this.compileShader("\n    precision mediump float;\n    varying lowp vec2 vTextureCoord;\n    uniform sampler2D YTexture;\n    uniform sampler2D UTexture;\n    uniform sampler2D VTexture;\n\n    const vec3 offset = vec3(-0.0627451017, -0.501960814, -0.501960814);\n\n    const mat3 YUV2RGB = mat3(\n        1.1644,  1.1644,   1.1644,\n        0,      -0.3918,   2.0172,\n        1.596,  -0.813,    0\n    );\n\n    void main()\n    {\n        mediump vec3 yuv;\n        lowp vec3 rgb;\n\n        yuv.x = texture2D(YTexture, vTextureCoord).r;\n        yuv.y = texture2D(UTexture, vTextureCoord).r;\n        yuv.z = texture2D(VTexture, vTextureCoord).r;\n\n        yuv += offset;\n        rgb = YUV2RGB * yuv;\n\n        gl_FragColor = vec4(rgb, 1);\n    }\n",e.FRAGMENT_SHADER),r=this.createProgram(t,n),a=e.getAttribLocation(r,"aVertexPosition");e.enableVertexAttribArray(a),this.textureCoordAttribute=e.getAttribLocation(r,"aTextureCoord"),e.enableVertexAttribArray(this.textureCoordAttribute);var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0]),e.STATIC_DRAW),e.vertexAttribPointer(a,3,e.FLOAT,!1,0,0),this.texCoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.STATIC_DRAW),e.vertexAttribPointer(this.textureCoordAttribute,2,e.FLOAT,!1,0,0),this.yTexture=this.createTexture(),this.uTexture=this.createTexture(),this.vTexture=this.createTexture(),this.bindTexture(this.yTexture,r,"YTexture",0),this.bindTexture(this.uTexture,r,"UTexture",1),this.bindTexture(this.vTexture,r,"VTexture",2)}},{key:"renderFrame",value:function(e,t,n,r,a,i,o){if(!this.gl)throw new Error("[VideoRender] Render frame failed due to WebGL not supported.");if(!this.isContextLost){var s=this.gl;this.width===i&&this.height===o||(this.logger.warn(this.TAG,"resolution change or init, old(w: ".concat(this.width,", h: ").concat(this.height,") new(w: ").concat(i,", h: ").concat(o)),this.width=i,this.height=o,this.uploadTexture(this.yTexture,t,o,null),this.uploadTexture(this.uTexture,a,o/2,null),this.uploadTexture(this.vTexture,a,o/2,null),this.updateVideoSize(i,o,t)),this.uploadTexture(this.yTexture,t,o,e,!0),this.uploadTexture(this.uTexture,a,o/2,n,!0),this.uploadTexture(this.vTexture,a,o/2,r,!0),s.drawArrays(s.TRIANGLE_STRIP,0,4),this.lastFrameData=null,this.lastFrameData=[e,t,n,r,a,i,o]}}},{key:"redrawLastFrame",value:function(){this.lastFrameData&&this.renderFrame.apply(this,M(this.lastFrameData))}},{key:"getLastFrameData",value:function(){return this.lastFrameData}},{key:"clear",value:function(){var e=this.gl;e.viewport(0,0,this.canvas.width,this.canvas.height),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),this.width=0,this.height=0}},{key:"destroy",value:function(){this.lastFrameData=null,this.uninitEventListener()}},{key:"compileShader",value:function(e,t){var n=this.gl,r=n.createShader(t);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))throw n.deleteShader(r),console.error(n.getShaderInfoLog(r)),new Error("[VideoRender] could not compile shader");return r}},{key:"createProgram",value:function(e,t){var n=this.gl,r=n.createProgram();if(n.attachShader(r,e),n.attachShader(r,t),n.linkProgram(r),n.useProgram(r),!n.getProgramParameter(r,n.LINK_STATUS))throw console.error(n.getProgramInfoLog(r)),new Error("[VideoRender] Shader link failed.");return r}},{key:"createTexture",value:function(){var e=this.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}},{key:"bindTexture",value:function(e,t,n,r){var a=this.gl;a.activeTexture([a.TEXTURE0,a.TEXTURE1,a.TEXTURE2][r]),a.bindTexture(a.TEXTURE_2D,e),a.uniform1i(a.getUniformLocation(t,n),r)}},{key:"uploadTexture",value:function(e,t,n,r,a){var i=this.gl;i.bindTexture(i.TEXTURE_2D,e),a?i.texSubImage2D(i.TEXTURE_2D,0,0,0,t,n,i.LUMINANCE,i.UNSIGNED_BYTE,r):i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,t,n,0,i.LUMINANCE,i.UNSIGNED_BYTE,r)}},{key:"updateVideoSize",value:function(e,t,n){var r,a,i=this.gl;if(n>0){var o=new Float32Array([1,0,0,0,1,1,0,1]),s=1*e/n;o[0]=s,o[4]=s,i.bindBuffer(i.ARRAY_BUFFER,this.texCoordBuffer),i.bufferData(i.ARRAY_BUFFER,o,i.STATIC_DRAW),i.vertexAttribPointer(this.textureCoordAttribute,2,i.FLOAT,!1,0,0)}e*i.canvas.height<t*i.canvas.width?(a=i.canvas.height,r=i.canvas.height*e/t):(r=i.canvas.width,a=i.canvas.width*t/e);var u=(i.canvas.width-r)/2,l=(i.canvas.height-a)/2;i.viewport(u,l,r,a)}},{key:"initEventListener",value:function(){this.canvas.addEventListener("webglcontextlost",this.webglcontextlostHandler),this.canvas.addEventListener("webglcontextrestored",this.webglcontextrestoredHandler)}},{key:"uninitEventListener",value:function(){this.canvas.removeEventListener("webglcontextlost",this.webglcontextlostHandler),this.canvas.removeEventListener("webglcontextrestored",this.webglcontextrestoredHandler)}}]),e}(),tt=function(){function e(){E(this,e),A(this,"logger",void 0),A(this,"TAG","[State]"),A(this,"startTime",void 0),A(this,"moduleLoadedTime",void 0),A(this,"corePlayerLoadStartTime",void 0),A(this,"corePlayerLoadedTime",void 0),A(this,"corePlayerOpenedTime",void 0),A(this,"firstFrameTime",void 0),A(this,"bestRenderLoopCount",void 0),A(this,"badRenderLoopCount",void 0),A(this,"delayFrameCount",void 0),A(this,"normalFrameCount",void 0),this.logger=O.getInstance(),this.startTime=window.performance&&window.performance.timing&&window.performance.timing.navigationStart,this.moduleLoadedTime=NaN,this.corePlayerLoadStartTime=NaN,this.corePlayerLoadedTime=NaN,this.corePlayerOpenedTime=NaN,this.firstFrameTime=NaN,this.bestRenderLoopCount=0,this.badRenderLoopCount=0,this.delayFrameCount=0,this.normalFrameCount=0}return T(e,[{key:"getCurrentTime",value:function(){return+new Date-this.startTime}},{key:"moduleLoaded",value:function(){this.moduleLoadedTime=this.getCurrentTime()}},{key:"corePlayerLoadStart",value:function(){this.corePlayerLoadStartTime=this.getCurrentTime()}},{key:"corePlayerLoaded",value:function(){this.corePlayerLoadedTime=this.getCurrentTime(),this.logger.warn(this.TAG,"corePlayerLoaded, it took ".concat(this.corePlayerLoadedTime," ms, ").concat(this.corePlayerLoadedTime-this.corePlayerLoadStartTime," ms"))}},{key:"corePlayerOpened",value:function(){this.corePlayerOpenedTime=this.getCurrentTime(),this.logger.warn(this.TAG,"corePlayerOpened, it took ".concat(this.corePlayerOpenedTime," ms, ").concat(this.corePlayerOpenedTime-this.corePlayerLoadStartTime," ms"))}},{key:"renderFirstFrame",value:function(){this.firstFrameTime=this.getCurrentTime(),this.logger.warn(this.TAG,"render first frame, it took ".concat(this.firstFrameTime," ms, ").concat(this.firstFrameTime-this.moduleLoadedTime," ms"))}},{key:"addBestRenderLoopCount",value:function(){this.bestRenderLoopCount+=1}},{key:"addBadRenderLoopCount",value:function(){this.badRenderLoopCount+=1}},{key:"addNormalFrameCount",value:function(){this.normalFrameCount+=1}},{key:"addDelayFrameCount",value:function(){this.delayFrameCount+=1}},{key:"reset",value:function(){this.startTime=+new Date,this.moduleLoaded(),this.bestRenderLoopCount=0,this.badRenderLoopCount=0,this.delayFrameCount=0,this.normalFrameCount=0}},{key:"getAllState",value:function(){return{moduleLoadedTime:this.moduleLoadedTime,corePlayerLoadStartTime:this.corePlayerLoadStartTime,corePlayerLoadedTime:this.corePlayerLoadedTime,corePlayerOpenedTime:this.corePlayerOpenedTime,firstFrameTime:this.firstFrameTime,bestRenderLoopCount:this.bestRenderLoopCount,badRenderLoopCount:this.badRenderLoopCount,normalFrameCount:this.normalFrameCount,delayFrameCount:this.delayFrameCount}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();A(tt,"instance",void 0);var nt,rt,at,it=tt,ot=n(333),st=n(418),ut=n(903);function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}!function(e){e[e.SOURCE=0]="SOURCE",e[e.MSE=1]="MSE",e[e.LIVE=2]="LIVE"}(nt||(nt={})),function(e){e.CORE_PLAYER_LOADED="coreplayerloaded",e.CORE_PLAYER_OPENED="coreplayeropened",e.CORE_PLAYER_READY="coreplayerready",e.ENDED="ended",e.SEEKED="seeked",e.TIMEUPDATE="timeupdate",e.CANPLAY="canplay"}(rt||(rt={})),function(e){e[e.SEEK_KEY=0]="SEEK_KEY",e[e.SEEK_POS=1]="SEEK_POS"}(at||(at={}));var ct=function(e){le(n,e);var t=lt(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nt.MSE;return E(this,n),A(ue(i=t.call(this)),"logger",void 0),A(ue(i),"TAG","[BwpMediaPlayer]"),A(ue(i),"BASE_DELAY_TIME",100),A(ue(i),"MAX_DELAY_TIME",800),A(ue(i),"MAX_DELAY_FRAME_COUNT",90),A(ue(i),"MIN_TIMEUPTE_INTERVAL",100),A(ue(i),"renderCanvas",void 0),A(ue(i),"bwpElement",void 0),A(ue(i),"errorCallback",void 0),A(ue(i),"sourceMode",void 0),A(ue(i),"width",void 0),A(ue(i),"height",void 0),A(ue(i),"_volume",void 0),A(ue(i),"_playbackRate",void 0),A(ue(i),"_currentTime",void 0),A(ue(i),"appendWindowStart",void 0),A(ue(i),"appendWindowEnd",void 0),A(ue(i),"videoRenderer",void 0),A(ue(i),"audioRenderer",void 0),A(ue(i),"audioSampleRate",void 0),A(ue(i),"audioChannels",void 0),A(ue(i),"pos",void 0),A(ue(i),"audioBuffer",void 0),A(ue(i),"videoBuffer",void 0),A(ue(i),"audioRenderBuffer",void 0),A(ue(i),"indexedDBUtils",void 0),A(ue(i),"glueJSUrl",void 0),A(ue(i),"pthreadWorkerUrl",void 0),A(ue(i),"wasmPlayerModule",void 0),A(ue(i),"wasmMemory",void 0),A(ue(i),"inputBuffer",void 0),A(ue(i),"inputBufferSize",void 0),A(ue(i),"screenShotCanvas",void 0),A(ue(i),"screenShotRenderer",void 0),A(ue(i),"wakeLock",void 0),A(ue(i),"isWakeLockInit",void 0),A(ue(i),"state",void 0),A(ue(i),"fps",void 0),A(ue(i),"totalVideoFrames",void 0),A(ue(i),"droppedVideoFrames",void 0),A(ue(i),"syncTimer",void 0),A(ue(i),"lastTimeUpdate",void 0),A(ue(i),"lastMainProcTime",void 0),A(ue(i),"outOfSyncFrameCount",void 0),A(ue(i),"isFirstFrame",void 0),A(ue(i),"isVideoSeeking",void 0),A(ue(i),"isWaiting",void 0),A(ue(i),"isReadyToRelegation",void 0),A(ue(i),"_isPictureInPicture",void 0),A(ue(i),"isEndOfStream",void 0),A(ue(i),"isInternalSeek",void 0),A(ue(i),"corePlayerInitAudio",void 0),A(ue(i),"corePlayerResumeTime",void 0),A(ue(i),"isDestroy",void 0),A(ue(i),"isCorePlayerLoaded",void 0),A(ue(i),"isCorePlayerOpened",void 0),A(ue(i),"videoRenderHandler",(function(e,t,n,r,a,o,s){if(t&&!i.isFirstFrame&&(i.state.renderFirstFrame(),i.isFirstFrame=!0,i.triggerCanplay()),!(t||n===i.width&&o===i.height||(0!==i.width&&0!==i.height&&Pe(i.bwpElement,ke.RESIZE),i.width=n,i.height=o,i.renderCanvas.width=i.width,i.renderCanvas.height=i.height,i.renderCanvas.style.lineHeight="0",i.renderCanvas)))throw new Error("Cannot get render canvas");if(t){var u=i.height*n,l=i.height*o/2,c=i.wasmMemory.buffer,d=new Uint8Array(c,t,u),f=new Uint8Array(c,r,l),h=new Uint8Array(c,a,l);i.videoRenderer.renderFrame(d,n,f,h,o,i.width,i.height);var p=1e3*i._currentTime-s;if(p>i.BASE_DELAY_TIME){if(i.state.addDelayFrameCount(),i.corePlayerResumeTime){if(+new Date-i.corePlayerResumeTime<3999)return;i.logger.log(i.TAG,"reset corePlayerResumeTime"),i.corePlayerResumeTime=0}if(!i.isReadyToRelegation&&p>i.MAX_DELAY_TIME){if(i.outOfSyncFrameCount+=1,i.outOfSyncFrameCount<i.MAX_DELAY_FRAME_COUNT)return;i.isReadyToRelegation=!0,setTimeout((function(){var e,t="Out of sync > 800ms, delay: ".concat(p,", currentTime: ").concat(i._currentTime,", frameTime: ").concat(s,", outOfSnycFrameCount: ").concat(i.outOfSyncFrameCount);i.logger.warn(i.TAG,t),null===(e=i.bwpElement)||void 0===e||e.dispatchEvent(new Se(oe.OUT_OF_SYNC,t))}),16)}}else i.state.addNormalFrameCount()}})),A(ue(i),"audioRenderHandler",(function(e,t,n,r,a){if(a===Ue.BBP_DATA_FLAG_FORMAT&&(i.logger.warn(i.TAG,"core player audio init, channel: ".concat(r,", sampleRate: ").concat(n)),1===r||2===r?(i.corePlayerInitAudio=!0,i.audioChannels=r,i.audioSampleRate!==n&&(i.audioSampleRate=n,i.audioRenderer.init(i.audioSampleRate)),i.triggerCanplay()):i.throwError(oe.AUDIO_CHANNELS_NOT_SUPPORT,"Audio channels not support(>2)")),0===a){var o=new Uint8Array(i.wasmPlayerModule.HEAPU8.subarray(t,t+n));i.audioRenderer.fillBuffer({data:o,size:n,time:r>=0?r:0,channels:i.audioChannels})}})),A(ue(i),"msgHandler",(function(e,t,n,r,a,o){switch(t){case Ue.BBP_MSG_OPEN_DONE:i.state.corePlayerOpened(),i.isCorePlayerOpened=!0,i.applyCorePlayerOfflineState(),Pe(ue(i),rt.CORE_PLAYER_OPENED),i.triggerCanplay();break;case Ue.BBP_MSG_PLAY_DUR:i.logger.warn(i.TAG,"[msg] [duration] ".concat(n));break;case Ue.BBP_MSG_PLAY_BUF:Ue.BBP_STRM_SOURCE,i.audioBuffer=n/1e3;break;case Ue.BBP_MSG_PLAY_POS:if(!i.isCorePlayerLoaded)return;if(n<0)return;var s=n/1e3,u=i._currentTime;i._currentTime=s,Promise.resolve().then((function(){var e,t=null===(e=i.bwpElement)||void 0===e?void 0:e.buffered;t&&t.length>0&&s>t.end(0)&&(s=t.end(0)),u!==s&&(i.lastTimeUpdate=+new Date,i.dispatchEvent(new Oe(rt.TIMEUPDATE,s))),i.readyStateChecker(t)}));break;case Ue.BBP_MSG_SEEK_DONE:i.isVideoSeeking=!1,i.triggerSeekedEvent();break;case Ue.BBP_MSG_PLAY_COMPLETE:i.logger.warn(i.TAG,"[msg] [play complete]"),i.resetKeepScreenAlive(),Pe(ue(i),rt.ENDED);break;case Ue.BBP_MSG_PLAY_QULITY:i.totalVideoFrames=n,i.droppedVideoFrames=r}})),A(ue(i),"onAbortHandler",(function(e){i.throwError(oe.CORE_PLAYER_EXCEPTION,e)})),A(ue(i),"audioprocessingCallback",(function(e,t){var n;if(i.audioRenderBuffer=t/1e3,-1!==e&&i.wasmPlayerModule._bbpAudio(e,t<900?2:0),e>=0&&(null===(n=i.bwpElement)||void 0===n||!n.paused)&&!i.isWaiting){var r=+new Date;r-i.lastTimeUpdate>i.MIN_TIMEUPTE_INTERVAL&&(i.lastTimeUpdate=r,i.dispatchEvent(new Oe(rt.TIMEUPDATE,e/1e3)))}performance.now()-i.lastMainProcTime>i.BASE_DELAY_TIME&&i.wasmPlayerModule._bbpMainProc()})),A(ue(i),"syncTimerHandler",(function(){var e;i.lastMainProcTime=performance.now(),null===(e=i.wasmPlayerModule)||void 0===e||e._bbpMainProc()})),A(ue(i),"applyCorePlayerOfflineState",(function(){0!==i._currentTime&&(i.logger.log(i.TAG,"applyCorePlayerOfflineState, have current time, seek to ".concat(i._currentTime)),i.seek(i._currentTime)),1!==i._playbackRate&&(i.logger.log(i.TAG,"applyCorePlayerOfflineState, have playbackrate !== 1, set ".concat(i._playbackRate)),i.playbackRate=i._playbackRate)})),A(ue(i),"audioCanplayHandler",(function(){var e,t;(i.triggerCanplay(),1!==i._volume)&&(i.logger.log(i.TAG,"applyCorePlayerOfflineState, have volume !== 1, set it ".concat(i._volume,", muted: ").concat(null===(e=i.bwpElement)||void 0===e?void 0:e.muted)),i.audioRenderer.volume=null!==(t=i.bwpElement)&&void 0!==t&&t.muted?0:i._volume)})),A(ue(i),"triggerCanplay",(function(){i.isReady()&&Pe(ue(i),rt.CANPLAY)})),A(ue(i),"setKeepScreenAlive",p(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.bwpElement.paused&&window.navigator.wakeLock&&!i.wakeLock&&!i.isWakeLockInit){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,i.isWakeLockInit=!0,e.next=6,window.navigator.wakeLock.request("screen");case 6:i.wakeLock=e.sent,e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(2),i.wakeLock=null,i.isWakeLockInit=!1,i.logger.warn(i.TAG,"[WakeLock] get wake lock failed,",e.t0),e.abrupt("return");case 15:i.logger.log(i.TAG,"[WakeLock] keep wake done");case 16:case"end":return e.stop()}}),e,null,[[2,9]])})))),A(ue(i),"resetKeepScreenAlive",p(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.wakeLock&&i.isWakeLockInit){e.next=2;break}return e.abrupt("return");case 2:return i.isWakeLockInit=!1,e.next=5,i.wakeLock.release();case 5:i.isWakeLockInit||(i.wakeLock=null,i.logger.log(i.TAG,"[WakeLock] release"));case 6:case"end":return e.stop()}}),e)})))),A(ue(i),"visibilityChangeHandler",(function(){i.isCorePlayerLoaded&&(i.getIsDocumentVisible()?(i.setSuspendCorePlayer(!1),i.setKeepScreenAlive()):i.isPictureInPicture||(i.setSuspendCorePlayer(!0),i.resetKeepScreenAlive()))})),A(ue(i),"globalErrorHandler",(function(e){var t,n,r=null==e?void 0:e.filename;r&&(i.pthreadWorkerUrl!==r&&i.glueJSUrl!==r&&(null===(t=window)||void 0===t||null===(n=t.__bwp__)||void 0===n?void 0:n.glueJSUrl)!=r||i.throwError(oe.CORE_PLAYER_EXCEPTION,e.message))})),A(ue(i),"throwError",(function(e,t){i.isDestroy||(i.errorCallback(e,t),i.destroy())})),i.logger=O.getInstance(),i.state=it.getInstance(),i.state.moduleLoaded(),i.renderCanvas=e,i.bwpElement=r,i.errorCallback=a,i.sourceMode=o,i.width=0,i.height=0,i._volume=1,i._playbackRate=1,i._currentTime=0,i.appendWindowStart=0,i.appendWindowEnd=0,i.audioSampleRate=44100,i.audioChannels=2,i.pos=0,i.audioBuffer=0,i.videoBuffer=0,i.audioRenderBuffer=0,i.indexedDBUtils=new S("bwphevc-live","lib"),i.isWakeLockInit=!1,i.fps=0,i.totalVideoFrames=0,i.droppedVideoFrames=0,i.lastTimeUpdate=0,i.lastMainProcTime=0,i.outOfSyncFrameCount=0,i.isFirstFrame=!1,i.isVideoSeeking=!1,i.isWaiting=!1,i.isReadyToRelegation=!1,i._isPictureInPicture=!1,i.isEndOfStream=!1,i.isInternalSeek=!1,i.corePlayerInitAudio=!1,i.corePlayerResumeTime=0,i.isDestroy=!1,i.isCorePlayerLoaded=!1,i.isCorePlayerOpened=!1,i.videoRenderer=new et(i.renderCanvas),window.AudioWorklet&&window.AudioWorkletNode?i.audioRenderer=new Ie(i.audioprocessingCallback,i.throwError):i.audioRenderer=new De(i.audioprocessingCallback,i.throwError),i.audioRenderer.addEventListener(we.INIT_DONE,i.audioCanplayHandler),i.audioRenderer.addEventListener(we.CANPLAY,i.audioCanplayHandler),i.audioRenderer.init(i.audioSampleRate),"WasmPlayerModuleFactory"in window||(i.glueJSUrl=URL.createObjectURL(new Blob([Q().simd?st:ut],{type:"application/javascript"})),window.__bwp__||(window.__bwp__={}),window.__bwp__.glueJsUrl=i.glueJSUrl),i.pthreadWorkerUrl=URL.createObjectURL(new Blob([ot],{type:"application/javascript"})),i.loadCorePlayer(),window.addEventListener("error",i.globalErrorHandler),document.addEventListener("visibilitychange",i.visibilityChangeHandler),i}return T(n,[{key:"muted",set:function(e){this.audioRenderer.volume=e?0:this._volume}},{key:"volume",get:function(){return this._volume},set:function(e){var t;this._volume=e,null!==(t=this.bwpElement)&&void 0!==t&&t.muted||(this.audioRenderer.volume=e)}},{key:"playbackRate",set:function(e){var t;this.logger.log(this.TAG,"set playbackRate: ".concat(e,", currentTime: ").concat(this._currentTime));var n=parseFloat(e.toFixed(2));this._playbackRate=n,this.isCorePlayerLoaded&&(null===(t=this.wasmPlayerModule)||void 0===t||t._bbpSpeed(100*n,100))}},{key:"isPictureInPicture",get:function(){return this._isPictureInPicture},set:function(e){this._isPictureInPicture=e,e&&this.isCorePlayerLoaded&&!this.getIsDocumentVisible()&&this.setSuspendCorePlayer(!1)}},{key:"play",value:function(){var e=this;return new Promise((function(t,n){if(e.isReady()&&e.canplay())e.getIsDocumentVisible()||e.isPictureInPicture||(e.setSuspendCorePlayer(!0),e.logger.log(e.TAG,"play in background tab, set not decoder & not render mode")),e.logger.log(e.TAG,"call play"),e.wasmPlayerModule._bbpPlay(),e.audioRenderer.play(),e.setKeepScreenAlive(),t();else{var r=new Error("Not ready");r.name="NotReady",n(r)}}))}},{key:"pause",value:function(){var e;this.isCorePlayerLoaded&&(null===(e=this.wasmPlayerModule)||void 0===e||e._bbpPause(),this.audioRenderer.pause(),this.resetKeepScreenAlive())}},{key:"seek",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:at.SEEK_POS,a=e>this._currentTime;if(this._currentTime=e,this.isVideoSeeking=!0,this.isEndOfStream=!1,this.isInternalSeek=n,null===(t=this.audioRenderer)||void 0===t||t.pause(),this.isCorePlayerLoaded){var i;this.logger.log(this.TAG,"start seek to: ".concat(e));var o=r===at.SEEK_POS?Ue.BBP_SEEK_LIVE|Ue.BBP_SEEK_POS:Ue.BBP_SEEK_LIVE|Ue.BBP_SEEK_KEY;null===(i=this.wasmPlayerModule)||void 0===i||i._bbpSeek(1e3*e,o),this.audioRenderBuffer=0,this.audioRenderer.seek(a?1e3*e:-1)}}},{key:"getVideoPlaybackQuality",value:function(){this.isCorePlayerLoaded&&this.wasmPlayerModule._bbpQuality();var e=new ge;return e.totalVideoFrames=this.totalVideoFrames,e.droppedVideoFrames=this.droppedVideoFrames,e}},{key:"isReady",value:function(){var e;return this.isCorePlayerLoaded&&this.corePlayerInitAudio&&(null===(e=this.audioRenderer)||void 0===e?void 0:e.isInitDone())&&this.isFirstFrame}},{key:"canplay",value:function(){var e;return null===(e=this.audioRenderer)||void 0===e?void 0:e.canPlay()}},{key:"appendBuffer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;if(this.checkCorePlayerModule(),this.sourceMode!==nt.MSE)throw new Error("Only the MSE mode is now supported!");this.logger.log(this.TAG,"[".concat(e,"] call append buffer,"),"byteLength: ".concat(t.byteLength)),e!==ie.VIDEO&&e!==ie.MIX||n===this.appendWindowStart&&r===this.appendWindowEnd||(this.appendWindowStart=n,this.appendWindowEnd=r,this.wasmPlayerModule._bbpRange(1e3*this.appendWindowStart,1e3*this.appendWindowEnd),this.logger.log(this.TAG,"set append window to core player: ".concat(n,", ").concat(r)));var a=t.byteLength;this.reallocInputBuffer(a);var i=new Uint8Array(this.wasmMemory.buffer,this.inputBuffer,a);if(i.set(new Uint8Array(t)),!this.inputBuffer)return this.pause(),this.throwError(oe.WASM_MEMORY_MALLOC_ERROR,"Malloc wasm shared memory error"),new Je;this.wasmPlayerModule._bbpFillBuff(Ue.BBP_STRM_SOURCE,this.pos,this.inputBuffer,a,0),this.pos+=a;var o=this._currentTime-.1;o<0&&(o=0);var s=0;return s=e===ie.MIX||ie.AUDIO?this.audioBuffer+this._currentTime+this.audioRenderBuffer:this.videoBuffer+this._currentTime+this.audioRenderBuffer,new Je([{start:o,end:s}])}},{key:"removeBuffer",value:function(e,t,n){this.checkCorePlayerModule()}},{key:"flushLastFrame",value:function(){var e;null===(e=this.videoRenderer)||void 0===e||e.clear()}},{key:"redrawLastFrame",value:function(){var e;null===(e=this.videoRenderer)||void 0===e||e.redrawLastFrame()}},{key:"endOfStream",value:function(){var e;this.isCorePlayerLoaded&&(this.logger.warn(this.TAG,"endOfStream"),null===(e=this.wasmPlayerModule)||void 0===e||e._bbpFillBuff(Ue.BBP_STRM_SOURCE,-1,0,0,0))}},{key:"setWaitingState",value:function(){this.isWaiting=!0}},{key:"getWaitingState",value:function(){return this.isWaiting}},{key:"toDataURL",value:function(e,t){this.screenShotCanvas||(this.screenShotCanvas=document.createElement("canvas")),this.screenShotCanvas.setAttribute("width","".concat(this.width,"px")),this.screenShotCanvas.setAttribute("height","".concat(this.height,"px"));var n,r=this.videoRenderer.getLastFrameData();r&&(this.screenShotRenderer||(this.screenShotRenderer=new et(this.screenShotCanvas,{alpha:!0,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1,powerPreference:"low-power"})),(n=this.screenShotRenderer).renderFrame.apply(n,M(r)));return this.screenShotCanvas.toDataURL(e,t)}},{key:"reload",value:function(){var e,t,n;(this.logger.warn(this.TAG,"reload, ready to flush core player"),this.resetKeepScreenAlive(),null!==(e=this.audioRenderer)&&void 0!==e&&e.isPlaying()&&this.pause(),this.isCorePlayerLoaded)&&(null===(n=this.wasmPlayerModule)||void 0===n||n._bbpFlush(Ue.BBP_STRM_SOURCE));this.resetBaseParams(),null===(t=this.audioRenderer)||void 0===t||t.seek(-1)}},{key:"destroy",value:function(){var e,t,n,r,a,i,o;window.removeEventListener("error",this.globalErrorHandler),this.resetKeepScreenAlive(),this.bwpElement=null,this.width=0,this.height=0,this.isDestroy=!0,null===(e=this.syncTimer)||void 0===e||e.stop(),null===(t=this.audioRenderer)||void 0===t||t.removeEventListener(we.CANPLAY,this.audioCanplayHandler),null===(n=this.audioRenderer)||void 0===n||n.removeEventListener(we.INIT_DONE,this.audioCanplayHandler),null===(r=this.audioRenderer)||void 0===r||r.destroy(),null===(a=this.videoRenderer)||void 0===a||a.destroy(),this.resetBaseParams(),this.screenShotRenderer&&(this.screenShotRenderer.destroy(),this.screenShotRenderer=null),this.screenShotCanvas&&(this.screenShotCanvas=null),null===(i=this.wasmPlayerModule)||void 0===i||i._bbpUninit(),null===(o=this.wasmPlayerModule)||void 0===o||o.terminateAllThreads(),this.inputBuffer&&this.wasmPlayerModule._free(this.inputBuffer),this.wasmPlayerModule=null,this.pthreadWorkerUrl&&URL.revokeObjectURL(this.pthreadWorkerUrl),document.removeEventListener("visibilitychange",this.visibilityChangeHandler)}},{key:"loadCorePlayer",value:function(){var e,t=this;this.state.corePlayerLoadStart();var n=function(){var n={locateFile:function(e,n){return e.endsWith("worker.js")?t.pthreadWorkerUrl:n+e},instantiateWasm:function(e,n){var r="libwpengn.wasm",a=function(e){n(e.instance,e.module)},i=Q().simd;(function(e,t,n,r){return g.apply(this,arguments)})(t.indexedDBUtils,r,e,i?L:I).then((function(e){return a(e)})).catch((function(){t.throwError(oe.CORE_PLAYER_LOAD_ERROR,"load wasm from indexedDB and url error or caching error")}))}};D||(n.print=function(e){}),window.WasmPlayerModuleFactory(n).then((function(n){t.isDestroy||(window.clearTimeout(e),t.state.corePlayerLoaded(),t.wasmPlayerModule=n,t.wasmPlayerModule.onAbort=t.onAbortHandler,t.wasmMemory=t.wasmPlayerModule.wasmMemory,t.isCorePlayerLoaded=!0,t.initCorePlayer(),Pe(t,rt.CORE_PLAYER_LOADED))})).catch((function(n){window.clearTimeout(e),t.throwError(oe.CORE_PLAYER_LOAD_ERROR,n&&n.toString&&n.toString())}))};if("WasmPlayerModuleFactory"in window)return this.logger.warn(this.TAG,"reuse window.WasmPlayerModuleFactory"),void n();e=window.setTimeout((function(){window.clearTimeout(e),t.throwError(oe.CORE_PLAYER_MODULE_LOAD_TIMEOUT,"Core player .wasm load timeout")}),1e4);var r=document.createElement("script");r.type="text/javascript",r.setAttribute("async","async"),r.src=this.glueJSUrl,document.body.appendChild(r),r.addEventListener("load",n),r.addEventListener("error",(function(){window.clearTimeout(e),t.throwError(oe.CORE_PLAYER_LOAD_ERROR,"Core player glue js load failed")}))}},{key:"initCorePlayer",value:function(){this.checkCorePlayerModule();var e=this.wasmPlayerModule.addFunction(this.msgHandler,"iiiiiii"),t=this.wasmPlayerModule.addFunction(this.audioRenderHandler,"iiiiii"),n=this.wasmPlayerModule.addFunction(this.videoRenderHandler,"iiiiiiii");e&&n&&t?(this.wasmPlayerModule._bbpInit(e,t,n),this.isDestroy&&(this.isDestroy=!1),this.wasmPlayerModule._bbpOpen(Ue.BBP_STRM_SOURCE,0,0,0),this.syncTimer=this.createTimer(this.syncTimerHandler,4),this.syncTimer.start()):this.throwError(oe.CORE_PLAYER_ADD_FUNCTION_ERROR,"Core player add function failed")}},{key:"reallocInputBuffer",value:function(e){this.inputBuffer&&this.inputBufferSize&&this.inputBufferSize>=e||(this.inputBuffer&&this.wasmPlayerModule._free(this.inputBuffer),this.logger.log(this.TAG,"remalloc input memory, last memory size: ".concat(this.inputBufferSize,", new size: ").concat(e)),this.inputBufferSize=e,this.inputBuffer=this.wasmPlayerModule._malloc(this.inputBufferSize))}},{key:"checkCorePlayerModule",value:function(){if(!this.wasmPlayerModule||!this.isCorePlayerLoaded)throw new Error("Core player module is not loaded or not opened!")}},{key:"resetBaseParams",value:function(){this._currentTime=0,this.appendWindowStart=0,this.appendWindowEnd=0,this.pos=0,this.audioBuffer=0,this.videoBuffer=0,this.audioRenderBuffer=0,this.state.reset(),this.fps=0,this.totalVideoFrames=0,this.droppedVideoFrames=0,this.isFirstFrame=!1,this.isVideoSeeking=!1,this.isWaiting=!1,this.isReadyToRelegation=!1,this._isPictureInPicture=!1,this.isEndOfStream=!1,this.isInternalSeek=!1,this.lastTimeUpdate=0,this.outOfSyncFrameCount=0,this.corePlayerInitAudio=!1,this.corePlayerResumeTime=0,this.flushLastFrame(),this.isCorePlayerOpened=!1}},{key:"createTimer",value:function(e,t){var n;return{start:function(){var r=this;n=window.setTimeout((function(){e(),r.start()}),t)},stop:function(){clearTimeout(n)}}}},{key:"triggerSeekedEvent",value:function(){var e;this.isVideoSeeking||(null!==(e=this.bwpElement)&&void 0!==e&&e.paused||this.audioRenderer.play(),this.isInternalSeek?(this.logger.warn(this.TAG,"inner seek done"),this.isInternalSeek=!1):(this.logger.warn(this.TAG,"seek done"),Pe(this,rt.SEEKED)))}},{key:"readyStateChecker",value:function(e){var t=this.bwpElement;if(!(null!=t&&t.paused||this.isEndOfStream)&&this.isReady()&&this.canplay()&&t&&t.readyState>=ne.HAVE_METADATA){var n=e&&e.length>0?e.start(0):0,r=e&&e.length>0?e.end(0):0;n===r||this._currentTime<n||this._currentTime>r?!this.isWaiting&&!this.isVideoSeeking&&this.audioRenderBuffer<=0&&(this.outOfSyncFrameCount>0&&(this.outOfSyncFrameCount=0),Pe(this.bwpElement,ke.WAITING),this.logger.warn(this.TAG,"[waiting] trigger internal seek, currentTime:",this._currentTime,r,t.duration),this.isWaiting=!0,this.seek(this._currentTime,!0)):r-this._currentTime>.1&&this.isWaiting&&(this.audioRenderer.isPlaying()||(this.play(),this.logger.warn(this.TAG,"[waiting] recovery play")),this.isWaiting=!1,this.logger.warn(this.TAG,"[waiting] end"),this.isVideoSeeking||Pe(this.bwpElement,ke.PLAYING))}}},{key:"getIsDocumentVisible",value:function(){return"visible"===document.visibilityState}},{key:"setSuspendCorePlayer",value:function(e){e?(this.wasmPlayerModule._bbpSetSuspend(1),this.corePlayerResumeTime=0):(this.wasmPlayerModule._bbpSetSuspend(0),this.corePlayerResumeTime=+new Date)}}]),n}(be),dt=ct;function ft(e,t){return e.start<=t.start&&t.start<=e.end&&e.end<=t.end?{start:t.start,end:e.end}:t.start<=e.start&&e.start<=t.end&&t.end<=e.end?{start:e.start,end:t.end}:t.start<=e.start&&e.start<=t.end&&e.end<=t.end?{start:e.start,end:e.end}:e.start<=t.start&&t.start<=e.end&&t.end<=e.end?{start:t.start,end:t.end}:null}var ht=T((function e(){E(this,e)})),pt=HTMLElement;"function"!=typeof HTMLElement&&(pt=ht);var mt=pt,bt=n(204),vt=function(){function e(t,n,r){var a=this;E(this,e),A(this,"bwpElement",void 0),A(this,"renderCanvas",void 0),A(this,"shadowRoot",void 0),A(this,"container",void 0),A(this,"styleElement",void 0),A(this,"hideTimer",void 0),A(this,"playBtn",void 0),A(this,"volumeBtn",void 0),A(this,"volumeProgress",void 0),A(this,"volumeCurrent",void 0),A(this,"volumeThumb",void 0),A(this,"fullscreenBtn",void 0),A(this,"moreBtn",void 0),A(this,"progressDiv",void 0),A(this,"thumbDiv",void 0),A(this,"playedDiv",void 0),A(this,"bufferedDiv",void 0),A(this,"currentTimeDiv",void 0),A(this,"durationDiv",void 0),A(this,"isShow",void 0),A(this,"isFullScreen",void 0),A(this,"isPlaying",void 0),A(this,"stateRefreshTimer",void 0),A(this,"canPlay",void 0),A(this,"currentTime",void 0),A(this,"duration",void 0),A(this,"muted",void 0),A(this,"volume",void 0),A(this,"PAUSE_ICON_CLASS_NAME","bwp-media-controls-icon-pause"),A(this,"EXIT_FULLSCREEN_ICON_CLASS_NAME","bwp-media-controls-icon-exit-fullscreen"),A(this,"createHideTimer",(function(){clearTimeout(a.hideTimer),a.hideTimer=setTimeout((function(){a.hide()}),3e3)})),A(this,"stateRefresh",(function(){if("visible"===document.visibilityState){var e=a.bwpElement.currentTime,t=a.bwpElement.duration;e>=0&&e!==a.currentTime&&(a.currentTime=e,a.currentTimeDiv.innerHTML=a.formatTime(e));var n=a.bwpElement.buffered.length>0?a.bwpElement.buffered.end(0):0;!a.canPlay&&a.bwpElement.readyState>=2&&a.canPlayHandler(),a.volume!==a.bwpElement.volume&&(a.volume=a.bwpElement.volume,a.muted||a.setVolume(a.volume)),a.muted!==a.bwpElement.muted&&(a.muted=a.bwpElement.muted,a.setVolume(a.muted?0:a.volume));var r=e/t||0;a.setScaleX(a.bufferedDiv,n/t||0),a.bwpElement.seeking||(a.setScaleX(a.playedDiv,r),a.setTranslateX(a.thumbDiv,r*a.progressDiv.offsetWidth)),a.switchPlayBtnState(!a.bwpElement.paused),t>0&&t!==a.duration&&t!==1/0&&(a.duration=t,a.durationDiv.innerHTML="&nbsp;/&nbsp;".concat(a.formatTime(t)))}a.stateRefreshTimer=setTimeout(a.stateRefresh,150)})),A(this,"onPlayBtnClick",(function(){a.canPlay&&(a.isPlaying?(a.bwpElement.pause(),a.switchPlayBtnState(!a.isPlaying)):a.bwpElement.play().then((function(){a.switchPlayBtnState(!a.isPlaying)})).catch((function(e){})))})),A(this,"onVolumeBtnClick",(function(){a.canPlay&&(a.bwpElement.volume>0&&!a.bwpElement.muted?(a.bwpElement.volume=0,a.volume=0,a.setVolume(0)):(a.bwpElement.muted&&(a.bwpElement.muted=!1),a.bwpElement.volume=1,a.volume=1,a.setVolume(1)))})),A(this,"onFullscreenBtnClick",(function(){a.canPlay&&(a.isFullScreen=!a.isFullScreen,a.isFullScreen?a.bwpElement.requestFullscreen().then((function(){a.switchBtnIcon(a.fullscreenBtn,a.EXIT_FULLSCREEN_ICON_CLASS_NAME,!0)})):document.exitFullscreen().then((function(){a.switchBtnIcon(a.fullscreenBtn,a.EXIT_FULLSCREEN_ICON_CLASS_NAME,!1)})))})),A(this,"onProgressClick",(function(e){if(a.canPlay&&a.duration>0){var t=e.offsetX/a.progressDiv.offsetWidth;a.bwpElement.currentTime=t*a.bwpElement.duration,a.setScaleX(a.bufferedDiv,t),a.setScaleX(a.playedDiv,t),a.setTranslateX(a.thumbDiv,e.offsetX)}})),A(this,"onVolumeTrackClick",(function(e){if(a.canPlay){var t=a.volumeProgress.offsetWidth,n=parseFloat((e.offsetX/t).toFixed(2));n>1?n=1:n<0&&(n=0),a.bwpElement.volume=n,a.volume=n,a.setVolume(n)}})),A(this,"onControlsMouseenter",(function(){clearTimeout(a.hideTimer)})),A(this,"onControlsMouseleave",(function(){a.createHideTimer()})),A(this,"onmouseenter",(function(){!a.isShow&&a.container&&a.show()})),A(this,"onmouseleave",(function(){a.isShow&&a.container&&a.hide()})),A(this,"onmousemove",(function(){a.isShow||a.show()})),A(this,"canPlayHandler",(function(){a.canPlay=!0,a.container.classList.remove("bwp-media-controls-disabled")})),A(this,"onfullscreenchange",(function(){a.isFullScreen&&null===document.fullscreenElement&&(a.isFullScreen=!1,a.switchBtnIcon(a.fullscreenBtn,a.EXIT_FULLSCREEN_ICON_CLASS_NAME,!1))})),this.bwpElement=t,this.renderCanvas=r,this.shadowRoot=n,this.isShow=!1,this.isFullScreen=!1,this.isPlaying=!1,this.canPlay=!1,this.currentTime=NaN,this.duration=NaN,this.muted=!1,this.volume=1}return T(e,[{key:"setupControls",value:function(){if(!this.shadowRoot)throw new Error("[BwpMediaControls] parent shadowRoot is null!");this.styleElement=document.createElement("style"),this.styleElement.innerHTML=bt.Z.toString(),this.shadowRoot.appendChild(this.styleElement),this.container=this.createDivElementWithClassName("bwp-media-controls bwp-media-controls-disabled");var e=this.createDivElementWithClassName("bwp-media-controls-button-panel");this.playBtn=this.createButtonPanelBtn(e,"bwp-media-controls-icon-play");var t=this.createDivElementWithClassName("bwp-media-controls-time-wrap");this.currentTimeDiv=document.createElement("div"),this.currentTimeDiv.innerHTML="0:00",this.durationDiv=document.createElement("div"),t.appendChild(this.currentTimeDiv),t.appendChild(this.durationDiv),e.appendChild(t);var n=this.createDivElementWithClassName("bwp-media-controls-button-panel-spacer");e.appendChild(n);var r=this.createDivElementWithClassName("bwp-media-controls-volume-container"),a=this.createDivElementWithClassName("bwp-media-controls-volume-track");this.volumeProgress=this.createDivElementWithClassName("bwp-media-controls-volume-progress"),this.volumeCurrent=this.createDivElementWithClassName("bwp-media-controls-volume-current"),this.volumeThumb=this.createDivElementWithClassName("bwp-media-controls-volume-thumb"),a.appendChild(this.volumeCurrent),a.appendChild(this.volumeThumb),a.appendChild(this.volumeProgress),r.appendChild(a),this.volumeBtn=this.createButtonPanelBtn(r,"bwp-media-controls-icon-volume"),e.appendChild(r),this.fullscreenBtn=this.createButtonPanelBtn(e,"bwp-media-controls-icon-fullscreen"),this.moreBtn=this.createButtonPanelBtn(e,"bwp-media-controls-icon-more"),this.container.appendChild(e);var i=this.createDivElementWithClassName("bwp-media-controls-timeline"),o=this.createDivElementWithClassName("bwp-media-controls-timeline-track");this.progressDiv=this.createDivElementWithClassName("bwp-media-controls-timeline-progress"),this.thumbDiv=this.createDivElementWithClassName("bwp-media-controls-timeline-thumb"),this.playedDiv=this.createDivElementWithClassName("bwp-media-controls-timeline-played"),this.bufferedDiv=this.createDivElementWithClassName("bwp-media-controls-timeline-buffered"),o.appendChild(this.progressDiv),o.appendChild(this.thumbDiv),o.appendChild(this.playedDiv),o.appendChild(this.bufferedDiv),i.appendChild(o),this.container.appendChild(i),this.shadowRoot.appendChild(this.container),this.setupEventListener(),this.stateRefresh()}},{key:"destroyControls",value:function(){if(!this.shadowRoot||!this.container||!this.styleElement)throw new Error("[BwoMediaControls] destroy controls must before setup!");clearTimeout(this.hideTimer),this.destroyEventListener(),this.shadowRoot.removeChild(this.container),this.shadowRoot.removeChild(this.styleElement),this.shadowRoot=null,this.isShow=!1,this.hideTimer=void 0}},{key:"show",value:function(){this.container&&(this.isShow=!0,this.container.style.display="block",this.createHideTimer())}},{key:"hide",value:function(){this.container&&(this.isShow=!1,this.container.style.display="none")}},{key:"setupEventListener",value:function(){var e,t;this.container.addEventListener("mouseenter",this.onControlsMouseenter),this.container.addEventListener("mouseleave",this.onControlsMouseleave),this.progressDiv.addEventListener("click",this.onProgressClick),null===(e=this.playBtn.parentElement)||void 0===e||e.addEventListener("click",this.onPlayBtnClick),this.volumeBtn.addEventListener("click",this.onVolumeBtnClick),this.volumeProgress.addEventListener("click",this.onVolumeTrackClick),null===(t=this.fullscreenBtn.parentElement)||void 0===t||t.addEventListener("click",this.onFullscreenBtnClick),this.bwpElement.addEventListener("mouseenter",this.onmouseenter),this.bwpElement.addEventListener("mouseleave",this.onmouseleave),this.bwpElement.addEventListener("mousemove",this.onmousemove),this.renderCanvas.addEventListener("click",this.onPlayBtnClick),document.addEventListener("fullscreenchange",this.onfullscreenchange)}},{key:"destroyEventListener",value:function(){this.bwpElement.removeEventListener("mouseenter",this.onmouseenter),this.bwpElement.removeEventListener("mouseleave",this.onmouseleave),this.bwpElement.removeEventListener("mousemove",this.onmousemove),clearTimeout(this.stateRefreshTimer),document.removeEventListener("fullscreenchange",this.onfullscreenchange)}},{key:"setVolume",value:function(e){var t=this.volumeBtn.classList;if(e<=0)t.contains("bwp-media-controls-icon-volume-mute")||t.add("bwp-media-controls-icon-volume-mute"),this.setScaleX(this.volumeCurrent,0),this.setTranslateX(this.volumeThumb,-46);else{t.contains("bwp-media-controls-icon-volume-mute")&&t.remove("bwp-media-controls-icon-volume-mute");var n=e>1?1:e;this.setScaleX(this.volumeCurrent,n),this.setTranslateX(this.volumeThumb,-46*(1-n))}}},{key:"switchPlayBtnState",value:function(e){this.isPlaying!==e&&(this.isPlaying=e,this.switchBtnIcon(this.playBtn,this.PAUSE_ICON_CLASS_NAME,this.isPlaying))}},{key:"createDivElementWithClassName",value:function(e){var t=document.createElement("div");return t.setAttribute("class",e),t}},{key:"createButtonPanelBtn",value:function(e,t,n){var r=document.createElement("div");r.setAttribute("class","bwp-media-controls-btn-wrap".concat(n?" ".concat(n):""));var a=document.createElement("div");a.setAttribute("class","bwp-media-controls-btn ".concat(t)),r.appendChild(a);var i=this.createDivElementWithClassName("bwp-media-controls-btn-background");return r.appendChild(i),e.appendChild(r),a}},{key:"switchBtnIcon",value:function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}},{key:"setScaleX",value:function(e,t){var n=t;n>1?n=1:n<0&&(n=0),e.setAttribute("style","transform: scaleX(".concat(n,");"))}},{key:"setTranslateX",value:function(e,t){e.setAttribute("style","transform: translateX(".concat(t,"px);"))}},{key:"formatTime",value:function(e){var t=Math.floor(e/3600),n=Math.floor(e/60%60);0!==t&&(n=n<10?"0".concat(n):n);var r=Math.floor(e%60);return r=r<10?"0".concat(r):r,0===t?"".concat(n,":").concat(r):"".concat(t,":").concat(n,":").concat(r)}}]),e}();function wt(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var yt=new WeakMap,gt=new WeakMap,Et=function(){function e(t,n){E(this,e),wt(this,yt,{writable:!0,value:void 0}),wt(this,gt,{writable:!0,value:void 0}),pe(this,yt,t),pe(this,gt,n)}return T(e,[{key:"code",get:function(){return he(this,yt)}},{key:"message",get:function(){return he(this,gt)}}]),e}(),_t=n(601);function Tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}var At,kt=function(e){le(n,e);var t=Tt(n);function n(e,r,a){var i;return E(this,n),A(ue(i=t.call(this,ke.ERROR,a)),"errorCode",void 0),A(ue(i),"describe",void 0),i.errorCode=e,i.describe=r,console.error("WasmPlayer error, errorCode: ".concat(e,", describe: ").concat(r)),i}return T(n)}(Te);function Rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}function St(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}!function(e){e.BUFFERED_UPDATE="buffered_update"}(At||(At={}));var Pt=new WeakMap,Mt=new WeakMap,xt=new WeakMap,Ct=new WeakMap,It=new WeakMap,Lt=new WeakMap,Bt=new WeakMap,Dt=new WeakMap,Nt=new WeakMap,Ot=new WeakMap,Wt=new WeakMap,Ut=new WeakMap,Ft=new WeakMap,jt=new WeakMap,Ht=new WeakMap,Gt=new WeakMap,Vt=new WeakMap,Yt=new WeakMap,zt=new WeakMap,Kt=new WeakMap,qt=new WeakMap,Xt=new WeakMap,Zt=new WeakMap,Qt=new WeakMap,Jt=new WeakMap,$t=new WeakMap,en=new WeakMap,tn=new WeakMap,nn=new WeakMap,rn=new WeakMap,an=new WeakMap,on=new WeakMap,sn=new WeakMap,un=new WeakMap,ln=new WeakMap,cn=new WeakMap,dn=new WeakMap,fn=new WeakMap,hn=new WeakMap,pn=new WeakMap,mn=new WeakMap,bn=new WeakMap,vn=new WeakMap,wn=new WeakMap,yn=new WeakMap,gn=new WeakMap,En=new WeakMap,_n=new WeakMap,Tn=new WeakMap,An=new WeakMap,kn=new WeakMap,Rn=new WeakMap,Sn=new WeakMap,Pn=new WeakMap,Mn=new WeakMap,xn=new WeakMap,Cn=new WeakMap,In=new WeakMap,Ln=new WeakMap,Bn=new WeakMap,Dn=new WeakMap,Nn=new WeakMap,On=new WeakMap,Wn=function(e){le(r,e);var t,n=Rt(r);function r(){var e,t,a;if(E(this,r),St(ue(e=n.call(this)),Pt,{writable:!0,value:void 0}),St(ue(e),Mt,{writable:!0,value:"[BwpElement]"}),St(ue(e),xt,{writable:!0,value:void 0}),St(ue(e),Ct,{writable:!0,value:void 0}),A(ue(e),"srcObject",void 0),St(ue(e),It,{writable:!0,value:void 0}),A(ue(e),"crossOrigin",void 0),A(ue(e),"NETWORK_EMPTY",te.NETWORK_EMPTY),A(ue(e),"NETWORK_IDLE",te.NETWORK_IDLE),A(ue(e),"NETWORK_LOADING",te.NETWORK_LOADING),A(ue(e),"NETWORK_NO_SOURCE",te.NETWORK_NO_SOURCE),St(ue(e),Lt,{writable:!0,value:void 0}),A(ue(e),"preload",void 0),St(ue(e),Bt,{writable:!0,value:void 0}),A(ue(e),"HAVE_NOTHING",ne.HAVE_NOTHING),A(ue(e),"HAVE_METADATA",ne.HAVE_METADATA),A(ue(e),"HAVE_CURRENT_DATA",ne.HAVE_CURRENT_DATA),A(ue(e),"HAVE_FUTURE_DATA",ne.HAVE_FUTURE_DATA),A(ue(e),"HAVE_ENOUGH_DATA",ne.HAVE_ENOUGH_DATA),St(ue(e),Dt,{writable:!0,value:void 0}),St(ue(e),Nt,{writable:!0,value:void 0}),St(ue(e),Ot,{writable:!0,value:void 0}),St(ue(e),Wt,{writable:!0,value:void 0}),St(ue(e),Ut,{writable:!0,value:void 0}),A(ue(e),"defaultPlaybackRate",void 0),St(ue(e),Ft,{writable:!0,value:void 0}),St(ue(e),jt,{writable:!0,value:void 0}),St(ue(e),Ht,{writable:!0,value:void 0}),St(ue(e),Gt,{writable:!0,value:void 0}),A(ue(e),"autoplay",void 0),A(ue(e),"loop",void 0),St(ue(e),Vt,{writable:!0,value:void 0}),St(ue(e),Yt,{writable:!0,value:void 0}),A(ue(e),"defaultMuted",void 0),A(ue(e),"videoTracks",null),A(ue(e),"audioTracks",null),A(ue(e),"textTracks",null),St(ue(e),zt,{writable:!0,value:void 0}),St(ue(e),Kt,{writable:!0,value:void 0}),St(ue(e),qt,{writable:!0,value:void 0}),St(ue(e),Xt,{writable:!0,value:void 0}),A(ue(e),"poster",void 0),A(ue(e),"playsInline",void 0),St(ue(e),Zt,{writable:!0,value:void 0}),St(ue(e),Qt,{writable:!0,value:void 0}),St(ue(e),Jt,{writable:!0,value:void 0}),St(ue(e),$t,{writable:!0,value:void 0}),St(ue(e),en,{writable:!0,value:void 0}),St(ue(e),tn,{writable:!0,value:void 0}),St(ue(e),nn,{writable:!0,value:void 0}),St(ue(e),rn,{writable:!0,value:void 0}),St(ue(e),an,{writable:!0,value:void 0}),St(ue(e),on,{writable:!0,value:void 0}),St(ue(e),sn,{writable:!0,value:void 0}),St(ue(e),un,{writable:!0,value:void 0}),St(ue(e),ln,{writable:!0,value:void 0}),St(ue(e),cn,{writable:!0,value:void 0}),St(ue(e),dn,{writable:!0,value:void 0}),St(ue(e),fn,{writable:!0,value:void 0}),St(ue(e),hn,{writable:!0,value:function(){var t="bwp-base-style",n=document.querySelector("#".concat(t));n||((n=document.createElement("style")).setAttribute("id",t),n.innerHTML="bwp-video { object-fit: contain; }",document.head.appendChild(n)),pe(ue(e),tn,e.attachShadow({mode:"closed"}));var r=document.createElement("style");r.innerHTML=_t.Z.toString(),he(ue(e),tn).appendChild(r),pe(ue(e),nn,document.createElement("div")),he(ue(e),nn).setAttribute("class","-bwp-internal-container"),he(ue(e),tn).appendChild(he(ue(e),nn)),he(ue(e),rn).setAttribute("class","-bwp-internal-render-canvas"),he(ue(e),nn).appendChild(he(ue(e),rn)),he(ue(e),un).setAttribute("class","-bwp-internal-proxy-video-element"),he(ue(e),nn).appendChild(he(ue(e),un)),e.getAttribute("controls")&&he(ue(e),pn).call(ue(e))}}),St(ue(e),pn,{writable:!0,value:function(){!he(ue(e),sn)&&he(ue(e),nn)&&(pe(ue(e),sn,new vt(ue(e),he(ue(e),nn),he(ue(e),rn))),he(ue(e),sn).setupControls())}}),St(ue(e),mn,{writable:!0,value:(t=p(b().mark((function t(){var n;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(he(ue(e),Lt)!==e.NETWORK_EMPTY){t.next=2;break}return t.abrupt("return");case 2:if(he(ue(e),Gt)&&he(ue(e),Ft)>0&&he(ue(e),yn).call(ue(e),0),he(ue(e),on)){t.next=5;break}return t.abrupt("return");case 5:if(!he(ue(e),Ut)){t.next=27;break}if(pe(ue(e),Ut,!1),Pe(ue(e),ke.PLAY),!(he(ue(e),Dt)<=e.HAVE_CURRENT_DATA)){t.next=14;break}he(ue(e),Pt).warn(he(ue(e),Mt),"[waiting] not enough data to play"),null===(n=he(ue(e),on))||void 0===n||n.setWaitingState(),Pe(ue(e),ke.WAITING),t.next=25;break;case 14:if(!(he(ue(e),Dt)>=e.HAVE_FUTURE_DATA)){t.next=25;break}return t.prev=15,t.next=18,he(ue(e),on).play();case 18:t.next=24;break;case 20:throw t.prev=20,t.t0=t.catch(15),pe(ue(e),Ut,!0),t.t0;case 24:Pe(ue(e),ke.PLAYING);case 25:t.next=28;break;case 27:he(ue(e),Dt),e.HAVE_ENOUGH_DATA;case 28:pe(ue(e),$t,!1);case 29:case"end":return t.stop()}}),t,null,[[15,20]])}))),function(){return t.apply(this,arguments)})}),St(ue(e),bn,{writable:!0,value:function(){he(ue(e),Lt)!==e.NETWORK_LOADING&&he(ue(e),Lt)!==e.NETWORK_IDLE||Pe(ue(e),ke.ABORT),he(ue(e),Lt)!==e.NETWORK_EMPTY&&(Pe(ue(e),ke.EMPTIED),he(ue(e),an)&&(pe(ue(e),Bt,new Je),he(ue(e),an).__deatch__(),he(ue(e),on).reload()),he(ue(e),Dt)!==e.HAVE_NOTHING&&(e.readyState=e.HAVE_NOTHING),he(ue(e),Ut)||pe(ue(e),Ut,!0),he(ue(e),Nt)&&pe(ue(e),Nt,!1),pe(ue(e),Ot,0),0!==he(ue(e),Zt)&&(pe(ue(e),Zt,0),Pe(ue(e),ke.TIME_UPDATE)),pe(ue(e),Wt,NaN)),e.playbackRate=e.defaultPlaybackRate,pe(ue(e),xt,null),pe(ue(e),$t,!0),he(ue(e),vn).call(ue(e))}}),St(ue(e),vn,{writable:!0,value:(a=p(b().mark((function t(){var n;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(pe(ue(e),Lt,e.NETWORK_NO_SOURCE),pe(ue(e),Jt,window.__bwp__&&window.__bwp__[he(ue(e),Ct)||""]),!(he(ue(e),Jt)instanceof MediaStream||he(ue(e),Jt)instanceof MediaSource||he(ue(e),Jt)instanceof gr||he(ue(e),Jt)instanceof Blob||he(ue(e),Jt)instanceof File)){t.next=6;break}n="object",t.next=17;break;case 6:if(!he(ue(e),Ct)&&""!==he(ue(e),Ct)){t.next=10;break}n="attribute",t.next=17;break;case 10:if(!e.children[0]||"SOURCE"!==e.children[0].tagName){t.next=14;break}n="children",t.next=17;break;case 14:return pe(ue(e),Lt,e.NETWORK_EMPTY),pe(ue(e),Bt,new Je),t.abrupt("return");case 17:if(he(ue(e),Pt).log(he(ue(e),Mt),"src: ".concat(he(ue(e),Ct),", mode: ").concat(n)),"object"!==n){t.next=25;break}pe(ue(e),Lt,e.NETWORK_LOADING),Pe(ue(e),ke.LOAD_START),pe(ue(e),It,""),he(ue(e),wn).call(ue(e)),t.next=30;break;case 25:if("attribute"!==n){t.next=29;break}throw new Error("[BwpElement] resourceSelectionAlgorithm not implemented mode attribute");case 29:throw new Error("[BwpElement] resourceSelectionAlgorithm not implemented mode other");case 30:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})}),St(ue(e),wn,{writable:!0,value:function(){var t;if(t=he(ue(e),Jt)?"local":"remote",pe(ue(e),It,he(ue(e),Ct)),"remote"===t)throw new Error("[BwpElement] resourceFetchArlgorithm not implemented mode remote");if(he(ue(e),Jt)&&he(ue(e),Jt)instanceof File)throw new Error("[BwpElement] resourceFetchArlgorithm not implemented local file");he(ue(e),Jt)&&he(ue(e),Jt)instanceof gr&&he(ue(e),Ct)&&(pe(ue(e),an,he(ue(e),Jt)),he(ue(e),an).readyState!==$.CLOSED||he(ue(e),gn).call(ue(e)))}}),St(ue(e),yn,{writable:!0,value:function(t){if(he(ue(e),Dt)!==e.HAVE_NOTHING){he(ue(e),Gt)&&pe(ue(e),Gt,!1),he(ue(e),Nt),pe(ue(e),Nt,!0);var n=t;if(n>he(ue(e),Wt)&&(n=he(ue(e),Wt)),he(ue(e),Pt).warn(he(ue(e),Mt),"currentTime is ".concat(he(ue(e),Zt),", seek to ").concat(n)),pe(ue(e),Zt,n),0!==e.seekable.length){Pe(ue(e),ke.SEEKING),pe(ue(e),Ot,n);var r=ue(e).buffered;he(ue(e),an)&&e.readyState>e.HAVE_METADATA&&(!r.length||n>r.end(0)||n<r.start(0))&&(e.readyState=e.HAVE_METADATA),he(ue(e),on).seek(n)}}}}),St(ue(e),gn,{writable:!0,value:function(){he(ue(e),an)&&(he(ue(e),Pt).log(he(ue(e),Mt),"attach BwpMediaSource"),delete window.__bwp__[he(ue(e),Ct)],he(ue(e),on).isCorePlayerLoaded&&Pe(ue(e),rt.CORE_PLAYER_READY))}}),St(ue(e),En,{writable:!0,value:function(){if(he(ue(e),Dt)>=ne.HAVE_METADATA){if(he(ue(e),Zt)>=he(ue(e),Wt)&&he(ue(e),Ft)>=0&&!e.loop)return!0;if(0===he(ue(e),Zt)&&he(ue(e),Ft)<0)return!0}return!1}}),St(ue(e),_n,{writable:!0,value:function(t,n){e.dispatchEvent(new kt(t,n)),pe(ue(e),xt,new Et(t,n))}}),St(ue(e),Tn,{writable:!0,value:function(){Pe(ue(e),rt.CORE_PLAYER_LOADED)}}),St(ue(e),An,{writable:!0,value:function(){Pe(ue(e),rt.CORE_PLAYER_OPENED)}}),St(ue(e),kn,{writable:!0,value:function(t){if(!(he(ue(e),Lt)<e.NETWORK_LOADING)){var n=t.currentTime;if(he(ue(e),Zt)!==n&&!he(ue(e),Gt)){pe(ue(e),Zt,n);var r=+new Date;r-he(ue(e),cn)>=200&&(pe(ue(e),cn,r),Pe(ue(e),ke.TIME_UPDATE))}}}}),St(ue(e),Rn,{writable:!0,value:function(){pe(ue(e),Nt,!1),0!==he(ue(e),Qt)&&pe(ue(e),Qt,0),Pe(ue(e),ke.TIME_UPDATE),Pe(ue(e),ke.SEEKED)}}),St(ue(e),Sn,{writable:!0,value:function(){he(ue(e),Pt).warn(he(ue(e),Mt),"play ended"),pe(ue(e),Zt,he(ue(e),Wt)),Pe(ue(e),ke.TIME_UPDATE),e.pause(),pe(ue(e),Gt,!0),Pe(ue(e),ke.ENDED)}}),St(ue(e),Pn,{writable:!0,value:function(){he(ue(e),dn)&&he(ue(e),Mn).call(ue(e)),he(ue(e),fn)&&he(ue(e),xn).call(ue(e)),he(ue(e),Cn).call(ue(e))}}),St(ue(e),Mn,{writable:!0,value:function(){var t;he(ue(e),on).isReady()&&he(ue(e),on).canplay()?(he(ue(e),dn)&&pe(ue(e),dn,!1),Pe(ue(e),ke.CANPLAY),he(ue(e),Pt).log(he(ue(e),Mt),"trigger canplay"),he(ue(e),Ut)||he(ue(e),$t)||e.seeking||null!==(t=he(ue(e),on))&&void 0!==t&&t.getWaitingState()||Pe(ue(e),ke.PLAYING)):pe(ue(e),dn,!0)}}),St(ue(e),xn,{writable:!0,value:function(){he(ue(e),on).isReady()&&he(ue(e),on).canplay()?(he(ue(e),fn)&&pe(ue(e),fn,!1),he(ue(e),Pt).log(he(ue(e),Mt),"trigger canplaythrough"),Pe(ue(e),ke.CANPLAY_THROUGH)):pe(ue(e),fn,!0)}}),St(ue(e),Cn,{writable:!0,value:function(){he(ue(e),on).isReady()&&e.autoplay&&he(ue(e),$t)&&e.readyState===e.HAVE_ENOUGH_DATA&&(he(ue(e),on).canplay()?(pe(ue(e),Ut,!1),he(ue(e),on).play().then((function(){he(ue(e),Pt).warn(he(ue(e),Mt),"trigger auto play, done"),Pe(ue(e),ke.PLAY),Pe(ue(e),ke.PLAYING)})).catch((function(){pe(ue(e),Ut,!0),he(ue(e),Pt).log(he(ue(e),Mt),"trigger auto play, failed, not ready")}))):he(ue(e),Pt).warn(he(ue(e),Mt),"trigger auto play, cannot auto play"),pe(ue(e),$t,!1))}}),St(ue(e),In,{writable:!0,value:function(){Pe(ue(e),ke.ENTER_PICTURE_IN_PICTURE)}}),St(ue(e),Ln,{writable:!0,value:function(){he(ue(e),on).isPictureInPicture=!1,he(ue(e),rn).style.visibility="visible",he(ue(e),un).style.display="none",he(ue(e),un).srcObject=null,pe(ue(e),ln,null),he(ue(e),un).removeEventListener(ke.ENTER_PICTURE_IN_PICTURE,he(ue(e),In)),he(ue(e),un).removeEventListener(ke.LEAVE_PICTURE_IN_PICTURE,he(ue(e),In)),Pe(ue(e),ke.LEAVE_PICTURE_IN_PICTURE)}}),St(ue(e),Bn,{writable:!0,value:function(){window.removeEventListener("beforeunload",he(ue(e),Bn)),e.destroy()}}),St(ue(e),Dn,{writable:!0,value:function(t){if(!he(ue(e),on))throw new Error("BwpMediaPlayer must be initialized first!");if(!(t instanceof gr&&t===he(ue(e),an)||t instanceof ir))throw new Error("Context must be bwp source")}}),St(ue(e),Nn,{writable:!0,value:function(){pe(ue(e),xt,new Et(re.MEDIA_ERR_SRC_NOT_SUPPORTED,"Media err src not supported.")),pe(ue(e),Lt,te.NETWORK_NO_SOURCE),Pe(ue(e),ke.ERROR)}}),St(ue(e),On,{writable:!0,value:function(e){return!!"".concat(e).match(/^[0-9]+.?[0-9]*$/)}}),!X())throw new Error("WasmPlayer not supported!");return pe(ue(e),Pt,O.getInstance()),pe(ue(e),xt,null),pe(ue(e),Ct,""),e.srcObject=null,pe(ue(e),It,""),e.crossOrigin=null,pe(ue(e),Lt,e.NETWORK_EMPTY),e.preload="metadata",pe(ue(e),Bt,new Je),pe(ue(e),Dt,e.HAVE_NOTHING),pe(ue(e),Nt,!1),pe(ue(e),Wt,NaN),pe(ue(e),Ut,!0),e.defaultPlaybackRate=1,pe(ue(e),Ft,1),pe(ue(e),jt,new Je),pe(ue(e),Ht,new Je),pe(ue(e),Gt,!1),e.autoplay=!1,e.loop=!1,pe(ue(e),Vt,!1),pe(ue(e),Yt,!1),e.defaultMuted=!1,pe(ue(e),zt,0),pe(ue(e),Kt,0),pe(ue(e),qt,0),pe(ue(e),Xt,0),e.poster="",e.playsInline=!1,pe(ue(e),Ot,0),pe(ue(e),Zt,0),pe(ue(e),Qt,0),pe(ue(e),$t,!0),pe(ue(e),cn,0),pe(ue(e),dn,!1),pe(ue(e),fn,!1),pe(ue(e),rn,document.createElement("canvas")),pe(ue(e),on,new dt(he(ue(e),rn),ue(e),he(ue(e),_n))),he(ue(e),on).addEventListener(rt.CORE_PLAYER_LOADED,he(ue(e),Tn)),he(ue(e),on).addEventListener(rt.CORE_PLAYER_OPENED,he(ue(e),An)),he(ue(e),on).addEventListener(rt.TIMEUPDATE,he(ue(e),kn)),he(ue(e),on).addEventListener(rt.SEEKED,he(ue(e),Rn)),he(ue(e),on).addEventListener(rt.ENDED,he(ue(e),Sn)),he(ue(e),on).addEventListener(rt.CANPLAY,he(ue(e),Pn)),pe(ue(e),un,document.createElement("video")),he(ue(e),hn).call(ue(e)),window.addEventListener("beforeunload",he(ue(e),Bn)),pe(ue(e),en,it.getInstance()),e}return T(r,[{key:"error",get:function(){return he(this,xt)}},{key:"src",get:function(){return he(this,Ct)},set:function(e){pe(this,Ct,e),this.setAttribute("src",e),he(this,bn).call(this)}},{key:"currentSrc",get:function(){return he(this,It)}},{key:"networkState",get:function(){return he(this,Lt)}},{key:"buffered",get:function(){if(he(this,an)){var e=he(this,an).activeSourceBuffers,t=e.length;if(0==t)return he(this,Bt);for(var n=e[0].buffered,r=1;r<t;r++){var a=e[r].buffered;a.length>0&&(n=ft(n,a)||new Je)}pe(this,Bt,n)}else he(this,Bt)||pe(this,Bt,new Je);return he(this,Bt)}},{key:"readyState",get:function(){return he(this,Dt)},set:function(e){var t=this;if(e!==he(this,Dt))if(this.networkState!==this.NETWORK_EMPTY){he(this,Pt).log(he(this,Mt),"Set readyState, new state is ".concat(e));var n=he(this,Dt);if(pe(this,Dt,e),n===this.HAVE_NOTHING&&e===this.HAVE_METADATA)he(this,Pt).log(he(this,Mt),"readyState change LOADED_METADATA"),Pe(this,ke.LOADED_METADATA),setTimeout((function(){0!==he(t,Qt)&&he(t,yn).call(t,he(t,Qt))}),1);else if(n===this.HAVE_METADATA&&e>=this.HAVE_CURRENT_DATA&&(Pe(this,ke.LOADED_DATA),e<this.HAVE_FUTURE_DATA))return;n>=this.HAVE_FUTURE_DATA&&e<=this.HAVE_CURRENT_DATA?he(this,En).call(this)||he(this,Ut)||(Pe(this,ke.TIME_UPDATE),Pe(this,ke.WAITING),he(this,Pt).log(he(this,Mt),"fire waiting")):n<=this.HAVE_CURRENT_DATA&&e===this.HAVE_FUTURE_DATA?he(this,Mn).call(this):e===this.HAVE_ENOUGH_DATA&&(n<=this.HAVE_CURRENT_DATA&&he(this,Mn).call(this),he(this,xn).call(this),he(this,Cn).call(this))}else he(this,Pt).log(he(this,Mt),"Network State is not ready, new readyState is ".concat(e))}},{key:"state",get:function(){return he(this,en).getAllState()}},{key:"seeking",get:function(){return he(this,Nt)}},{key:"currentTime",get:function(){return he(this,Zt)},set:function(e){0!==he(this,Qt)&&pe(this,Qt,0),he(this,Dt)===this.HAVE_NOTHING?0!==e&&pe(this,Qt,e):he(this,yn).call(this,e)}},{key:"duration",get:function(){return he(this,Wt)},set:function(e){pe(this,Wt,e)}},{key:"paused",get:function(){return he(this,Ut)}},{key:"playbackRate",get:function(){return he(this,Ft)},set:function(e){e!==he(this,Ft)&&(pe(this,Ft,e),he(this,on)&&(he(this,on).playbackRate=e),Pe(this,ke.RATE_CHANGE))}},{key:"played",get:function(){return he(this,jt)}},{key:"seekable",get:function(){return he(this,an)?this.buffered:he(this,Ht)}},{key:"ended",get:function(){return he(this,En).call(this)}},{key:"controls",get:function(){return he(this,Vt)},set:function(e){e!==he(this,Vt)&&(e?this.setAttribute("controls",""):this.removeAttribute("controls"))}},{key:"muted",get:function(){return he(this,Yt)},set:function(e){e!=he(this,Yt)&&(pe(this,Yt,e),he(this,on)&&(he(this,on).muted=e),Pe(this,ke.VOLUME_CHANGE))}},{key:"volume",get:function(){var e;return(null===(e=he(this,on))||void 0===e?void 0:e.volume)||0},set:function(e){if(e<0||e>1)throw new DOMException("IndexSizeError");if(he(this,on)){if(e==he(this,on).volume)return;he(this,on).volume=e,Pe(this,ke.VOLUME_CHANGE)}}},{key:"width",get:function(){return he(this,zt)},set:function(e){this.setAttribute("width",he(this,On).call(this,e)?e.toString():"0")}},{key:"height",get:function(){return he(this,Kt)},set:function(e){this.setAttribute("height",he(this,On).call(this,e)?e.toString():"0")}},{key:"videoWidth",get:function(){return he(this,rn).width}},{key:"videoHeight",get:function(){return he(this,rn).height}},{key:"load",value:function(){he(this,bn).call(this)}},{key:"canPlayType",value:function(e){return"probably"}},{key:"play",value:(t=p(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!he(this,on)||null!==(t=he(this,on))&&void 0!==t&&t.canplay()){e.next=2;break}throw new DOMException("play() failed because the user didn't interact with the document first.","NotAllowedError");case 2:if(!he(this,xt)||he(this,xt).code!==re.MEDIA_ERR_SRC_NOT_SUPPORTED){e.next=4;break}throw new Ye;case 4:return e.abrupt("return",he(this,mn).call(this));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pause",value:function(){var e;he(this,Lt)!==this.NETWORK_EMPTY&&(pe(this,$t,!1),he(this,Ut)||(pe(this,Ut,!0),Pe(this,ke.TIME_UPDATE),Pe(this,ke.PAUSE),null===(e=he(this,on))||void 0===e||e.pause()))}},{key:"addTextTrack",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"getVideoPlaybackQuality",value:function(){return he(this,on)?he(this,on).getVideoPlaybackQuality():new ge}},{key:"requestPictureInPicture",value:function(){var e=this;if(he(this,Pt).log(he(this,Mt),"requestPictureInPicture"),!document.pictureInPictureEnabled)throw new Ye;if(he(this,Dt)===this.HAVE_NOTHING)throw new ze;return document.pictureInPictureElement instanceof r?he(this,un).requestPictureInPicture():new Promise((function(t,n){he(e,on).isPictureInPicture=!0,pe(e,ln,he(e,rn).captureStream(30));var r=he(e,un);r.addEventListener(ke.LOADED_METADATA,(function a(){he(e,Pt).log(he(e,Mt),"browser video element loaded metadata"),r.removeEventListener(ke.LOADED_METADATA,a),r.addEventListener(ke.ENTER_PICTURE_IN_PICTURE,he(e,In)),r.addEventListener(ke.LEAVE_PICTURE_IN_PICTURE,he(e,Ln)),r.requestPictureInPicture().then((function(n){he(e,un).style.display="block",he(e,rn).style.visibility="hidden",t(n)})).catch((function(t){he(e,on).isPictureInPicture=!1,pe(e,ln,null),console.error(t),n(t)}))})),r.srcObject=he(e,ln),r.play(),he(e,Ut)&&he(e,on).redrawLastFrame()}))}},{key:"destroy",value:function(){he(this,Pt).warn(he(this,Mt),"call destroy"),he(this,on)&&(he(this,on).removeEventListener(rt.CORE_PLAYER_LOADED,he(this,Tn)),he(this,on).removeEventListener(rt.CORE_PLAYER_OPENED,he(this,An)),he(this,on).removeEventListener(rt.TIMEUPDATE,he(this,kn)),he(this,on).removeEventListener(rt.SEEKED,he(this,Rn)),he(this,on).removeEventListener(rt.ENDED,he(this,Sn)),he(this,on).removeEventListener(rt.CANPLAY,he(this,Pn)),window.removeEventListener("beforeunload",he(this,Bn)),he(this,on).destroy()),pe(this,on,null),pe(this,an,null)}},{key:"toDataURL",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.92;return null===(e=he(this,on))||void 0===e?void 0:e.toDataURL(t,n)}},{key:"__appendBuffer__",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;return he(this,Dn).call(this,e),null===(r=he(this,on))||void 0===r?void 0:r.appendBuffer(t,n,a,i)}},{key:"__removeBuffer__",value:function(e,t,n,r){var a;he(this,Dn).call(this,e),null===(a=he(this,on))||void 0===a||a.removeBuffer(t,n,r)}},{key:"__endOfStream__",value:function(e){var t;he(this,Dn).call(this,e),null===(t=he(this,on))||void 0===t||t.endOfStream()}},{key:"connectedCallback",value:function(){he(this,Pt).log(he(this,Mt),"connectedCallback")}},{key:"disconnectedCallback",value:function(){he(this,Pt).warn(he(this,Mt),"disconnectedCallback")}},{key:"adoptedCallback",value:function(){he(this,Pt).warn(he(this,Mt),"adoptedCallback")}},{key:"attributeChangedCallback",value:function(e,t,n){he(this,Pt).log(he(this,Mt),"attribute change, name: ".concat(e,", oldValue: ").concat(t,", newValue: ").concat(n));var r=Number.parseInt(n,10);switch(e){case"controls":var a;if(null===t)he(this,pn).call(this),pe(this,Vt,!0);else null===(a=he(this,sn))||void 0===a||a.destroyControls(),pe(this,sn,null),pe(this,Vt,!1);break;case"autoplay":this.autoplay=null===t;break;case"src":he(this,Ct)!==n&&pe(this,Ct,n);break;case"style":default:break;case"loop":this.loop=null===t;break;case"width":if(!he(this,nn))return;if(null===n||""===n){he(this,nn).style.width="";break}if(he(this,zt)===r&&he(this,nn).style.width===n)break;if(Number.isNaN(r)||r<0){pe(this,zt,0);break}pe(this,zt,r),-1!==n.indexOf("%")?he(this,nn).style.width="".concat(r,"%"):he(this,nn).style.width="".concat(r,"px");break;case"height":if(!he(this,nn))return;if(null===n||""===n){he(this,nn).style.height="";break}if(he(this,Kt)===r&&he(this,nn).style.height===n)break;if(Number.isNaN(r)||r<0){pe(this,Kt,0);break}pe(this,Kt,r),-1!==n.indexOf("%")?he(this,nn).style.height="".concat(r,"%"):he(this,nn).style.height="".concat(r,"px")}}}],[{key:"observedAttributes",get:function(){return["controls","autoplay","src","style","loop","width","height"]}}]),r}(mt),Un=Wn;function Fn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}function jn(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var Hn=new WeakMap,Gn=new WeakMap,Vn=new WeakMap,Yn=new WeakMap,zn=new WeakMap,Kn=new WeakMap,qn=new WeakMap,Xn=new WeakMap,Zn=new WeakMap,Qn=new WeakMap,Jn=new WeakMap,$n=new WeakMap,er=new WeakMap,tr=new WeakMap,nr=new WeakMap,rr=new WeakMap,ar=new WeakMap,ir=function(e){le(n,e);var t=Fn(n);function n(e,r,a,i){var o;return E(this,n),jn(ue(o=t.call(this)),Hn,{writable:!0,value:void 0}),jn(ue(o),Gn,{writable:!0,value:"[BwpSourceBuffer]"}),jn(ue(o),Vn,{writable:!0,value:void 0}),A(ue(o),"updating",void 0),jn(ue(o),Yn,{writable:!0,value:void 0}),jn(ue(o),zn,{writable:!0,value:void 0}),A(ue(o),"audioTracks",null),A(ue(o),"videoTracks",null),A(ue(o),"textTracks",null),jn(ue(o),Kn,{writable:!0,value:void 0}),jn(ue(o),qn,{writable:!0,value:void 0}),A(ue(o),"onupdatestart",void 0),A(ue(o),"onupdate",void 0),A(ue(o),"onupdateend",void 0),A(ue(o),"onerror",void 0),A(ue(o),"onabort",void 0),jn(ue(o),Xn,{writable:!0,value:void 0}),jn(ue(o),Zn,{writable:!0,value:void 0}),jn(ue(o),Qn,{writable:!0,value:void 0}),jn(ue(o),Jn,{writable:!0,value:void 0}),jn(ue(o),$n,{writable:!0,value:void 0}),jn(ue(o),er,{writable:!0,value:.1}),jn(ue(o),tr,{writable:!0,value:function(){o.updating=!1,Pe(ue(o),"update"),Pe(ue(o),"updateend")}}),jn(ue(o),nr,{writable:!0,value:function(){if(he(ue(o),ar).call(ue(o)),null!==he(ue(o),Qn).error)throw new ze;he(ue(o),$n).call(ue(o))}}),jn(ue(o),rr,{writable:!0,value:function(){return-1===he(ue(o),Jn).sourceBuffers.indexOf(ue(o))}}),jn(ue(o),ar,{writable:!0,value:function(){if(he(ue(o),rr).call(ue(o)))throw new ze;if(o.updating)throw new Error("This SourceBuffer is still processing an 'appendBuffer' or 'remove' operation.")}}),pe(ue(o),Hn,O.getInstance()),pe(ue(o),Zn,e),pe(ue(o),Qn,r),pe(ue(o),Jn,a),pe(ue(o),$n,i),o.updating=!1,pe(ue(o),Yn,new Je),pe(ue(o),zn,0),pe(ue(o),qn,1/0),pe(ue(o),Kn,0),pe(ue(o),Xn,!1),he(ue(o),Qn).addEventListener(At.BUFFERED_UPDATE,he(ue(o),tr)),he(ue(o),Hn).log(he(ue(o),Gn),"SOURCE BUFFER CREATE"),o}return T(n,[{key:"mode",get:function(){return he(this,Vn)},set:function(e){if(e===ae.SEQUENCE)throw new Error("Mode sequence is not implemented!");if(he(this,ar).call(this),he(this,Xn)&&"segments"===e)throw new TypeError("GenerateTimestampsFlag is true, not support segments mode");he(this,$n).call(this),he(this,Jn).readyState&&he(this,Hn).log(he(this,Gn),"[".concat(he(this,Zn),"] MediaSource is working fine!, readyState:"),he(this,Jn).readyState.toString()),pe(this,Vn,e)}},{key:"buffered",get:function(){return he(this,rr).call(this)?(pe(this,Yn,new Je),he(this,Yn)):he(this,Yn)}},{key:"timestampOffset",get:function(){return he(this,zn)},set:function(e){he(this,ar).call(this),he(this,$n).call(this),pe(this,zn,e)}},{key:"appendWindowStart",get:function(){return he(this,Kn)},set:function(e){if(he(this,Hn).log(he(this,Gn),"[".concat(he(this,Zn),"] set appendWindowStart: ").concat(e)),he(this,ar).call(this),e<0||e>=he(this,qn))throw new TypeError("AppendWindowStart cannot greater than or equal End.");pe(this,Kn,e)}},{key:"appendWindowEnd",get:function(){return he(this,qn)},set:function(e){if(he(this,Hn).log(he(this,Gn),"[".concat(he(this,Zn),"] set appendWindowEnd: ").concat(e)),he(this,ar).call(this),Number.isNaN(e))throw new TypeError;if(e<=he(this,Kn))throw new TypeError("AppendWindowEnd cannot less then or equal Start.");pe(this,qn,e)}},{key:"appendBuffer",value:function(e){he(this,nr).call(this),this.updating=!0,this.dispatchEvent(new Event("updatestart"));var t=he(this,Qn).__appendBuffer__(this,he(this,Zn),e,he(this,Kn),he(this,qn));pe(this,Yn,t);var n=0,r=0;t.length>0&&(n=t.start(0),r=t.end(0)),he(this,Qn).readyState===ne.HAVE_NOTHING&&(he(this,Qn).readyState=ne.HAVE_METADATA);var a=he(this,Qn).currentTime;r>n&&a>=n&&(he(this,Qn).readyState===ne.HAVE_METADATA&&(he(this,Qn).readyState=ne.HAVE_CURRENT_DATA),he(this,Qn).readyState===ne.HAVE_METADATA&&(he(this,Qn).readyState=ne.HAVE_CURRENT_DATA),he(this,Qn).readyState===ne.HAVE_CURRENT_DATA&&r>a&&(he(this,Qn).readyState=ne.HAVE_FUTURE_DATA),he(this,Qn).readyState===ne.HAVE_FUTURE_DATA&&r-n>=he(this,er)&&(he(this,Qn).readyState=ne.HAVE_ENOUGH_DATA)),he(this,Qn).readyState>=ne.HAVE_METADATA&&Pe(he(this,Qn),ke.PROGRESS),he(this,tr).call(this)}},{key:"abort",value:function(){if(he(this,rr).call(this))throw new Error("This SourceBuffer has been removed from the parent media source.");if(he(this,Jn).readyState!==$.OPEN)throw new ze;this.updating&&(he(this,Hn).log(he(this,Gn),"[".concat(he(this,Zn),"] Call abort when this.updating is true.")),this.updating=!1,Pe(this,"abort"),Pe(this,"updateend")),this.appendWindowStart=0,this.appendWindowEnd=Number.POSITIVE_INFINITY}},{key:"remove",value:function(e,t){he(this,ar).call(this),he(this,Hn).warn(he(this,Gn),"[".concat(he(this,Zn),"] remove buffer: ").concat(e,", ").concat(t));var n=he(this,Jn).duration;if(Number.isNaN(n))throw new TypeError("MediaSource duration cannot NaN");if(e<0||e>n)throw new TypeError("Start must be valid.");if(t<=e||Number.isNaN(t))throw new TypeError("End must be valid.");he(this,$n).call(this),he(this,Qn).__removeBuffer__(this,he(this,Zn),e,t)}}]),n}(be);function or(){or=function(e,t){return new r(e,void 0,t)};var t=RegExp.prototype,n=new WeakMap;function r(e,t,a){var i=new RegExp(e,t);return n.set(i,a||n.get(e)),se(i,r.prototype)}function a(e,t){var r=n.get(t);return Object.keys(r).reduce((function(t,n){return t[n]=e[r[n]],t}),Object.create(null))}return le(r,RegExp),r.prototype.exec=function(e){var n=t.exec.call(this,e);return n&&(n.groups=a(n,this)),n},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var o=n.get(this);return t[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+o[t]})))}if("function"==typeof i){var s=this;return t[Symbol.replace].call(this,r,(function(){var t=arguments;return"object"!=e(t[t.length-1])&&(t=[].slice.call(t)).push(a(t,s)),i.apply(this,t)}))}return t[Symbol.replace].call(this,r,i)},or.apply(this,arguments)}function sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var a=de(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return ce(this,n)}}function ur(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var lr=new WeakMap,cr=new WeakMap,dr=new WeakMap,fr=new WeakMap,hr=new WeakMap,pr=new WeakMap,mr=new WeakMap,br=new WeakMap,vr=new WeakMap,wr=new WeakMap,yr=new WeakMap,gr=function(e){le(n,e);var t=sr(n);function n(){var e;return E(this,n),ur(ue(e=t.call(this)),lr,{writable:!0,value:void 0}),ur(ue(e),cr,{writable:!0,value:"[BwpMediaSource]"}),A(ue(e),"sourceBuffers",void 0),A(ue(e),"activeSourceBuffers",void 0),ur(ue(e),dr,{writable:!0,value:void 0}),ur(ue(e),fr,{writable:!0,value:void 0}),A(ue(e),"onsourceopen",void 0),A(ue(e),"onsourceended",void 0),A(ue(e),"onsourceclose",void 0),ur(ue(e),hr,{writable:!0,value:void 0}),ur(ue(e),pr,{writable:!0,value:void 0}),ur(ue(e),mr,{writable:!0,value:function(t){if(he(ue(e),fr)!==t){for(var n=NaN,r=0;r<e.sourceBuffers.length;r++){var a=e.sourceBuffers[r].buffered;if(a.length>0){var i=a.end(a.length-1);i>-1&&(!n||i>n)&&(n=i)}}if(n&&t<n)throw new Error("InvalidStateError, duration must be valid");pe(ue(e),fr,t),he(ue(e),pr).duration=t}}}),ur(ue(e),br,{writable:!0,value:function(t){if(pe(ue(e),dr,$.ENDED),Pe(ue(e),"sourceended"),he(ue(e),lr).warn(he(ue(e),cr),"source ended"),t)("network"===t||"decode"===t)&&(he(ue(e),pr).readyState,ne.HAVE_NOTHING,he(ue(e),pr).readyState,ne.HAVE_NOTHING);else{for(var n=0,r=0;r<e.sourceBuffers.length;r++){var a=e.sourceBuffers[r].buffered;if(a.length>0){var i=a.end(a.length-1);i>n&&(n=i)}}he(ue(e),mr).call(ue(e),n)}}}),A(ue(e),"createObjectURL",(function(t){if(!(t&&t instanceof Un))throw new Error("Must have valid bwp element");pe(ue(e),pr,t),he(ue(e),pr).addEventListener(rt.CORE_PLAYER_LOADED,he(ue(e),vr)),he(ue(e),pr).addEventListener(rt.CORE_PLAYER_READY,he(ue(e),vr)),window.__bwp__||(window.__bwp__={});var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),r="blob:".concat(window.location.origin,"/").concat(n);return window.__bwp__[r]=ue(e),r})),ur(ue(e),vr,{writable:!0,value:function(){he(ue(e),wr).call(ue(e)),he(ue(e),dr)!==$.OPEN&&(pe(ue(e),dr,$.OPEN),Pe(ue(e),"sourceopen"),he(ue(e),lr).log(he(ue(e),cr),"source open"))}}),ur(ue(e),wr,{writable:!0,value:function(){he(ue(e),pr).removeEventListener(rt.CORE_PLAYER_LOADED,he(ue(e),vr)),he(ue(e),pr).removeEventListener(rt.CORE_PLAYER_READY,he(ue(e),vr))}}),ur(ue(e),yr,{writable:!0,value:function(){he(ue(e),dr)===$.ENDED&&(pe(ue(e),dr,$.OPEN),Pe(ue(e),"sourceopen"),he(ue(e),lr).log(he(ue(e),cr),"source open"))}}),pe(ue(e),lr,O.getInstance()),e.sourceBuffers=new ye,e.activeSourceBuffers=new ye,pe(ue(e),dr,$.CLOSED),pe(ue(e),fr,NaN),pe(ue(e),hr,!0),he(ue(e),lr).log(he(ue(e),cr),"MediaSource CREATE, readyState is: ".concat(he(ue(e),dr))),e}return T(n,[{key:"readyState",get:function(){return he(this,dr)}},{key:"duration",get:function(){return he(this,dr)===$.CLOSED?NaN:he(this,fr)},set:function(e){if(!e||e<0)throw new TypeError("Failed to set the 'duration' property on 'BwpMediaSource': The duration provided (".concat(e,") is less than the minimum bound (0)."));if(he(this,dr)!==$.OPEN)throw new DOMException("Failed to set the 'duration' property on 'BwpMediaSource': The BwpMediaSource's readyState is not 'open'.");he(this,mr).call(this,e)}},{key:"addSourceBuffer",value:function(e){if(!e||!e.trim())throw new TypeError("Failed to execute 'addSourceBuffer' on 'MediaSource': The type provided is empty");var t=e.match(or(/(video|audio)\/mp4;.*?codecs="(hev|mp4a|hvc).*?(,(hev|mp4a|hvc).*?|)"(;width="(.*?)";height="(.*?)"|)/,{mediaType:1,codec:2,codec2:4,width:6,height:7})),n=null==t?void 0:t.groups;if(!t||!n)throw new DOMException("Failed to execute 'addSourceBuffer' on 'MediaSource': The type provided ('".concat(e,"') is unsupported."));var r,a=n.mediaType,i=n.codec,o=n.codec2;if(!a||!i)throw new DOMException("Failed to execute 'addSourceBuffer' on 'MediaSource': The type provided ('".concat(e,"') is unsupported."));if("video"===a){var s={hev:!0,hvc:!0};pe(this,hr,!(!s[i]&&!s[o]))}if(he(this,lr).log(he(this,cr),"ready to add SourceBuffer: ".concat(e,", isHEVC: ").concat(he(this,hr),", readyState: ").concat(this.readyState)),!he(this,hr))throw new Error("H.264 not implemented");if(he(this,dr)!==$.OPEN)throw new Error("InvalidStateError, BwpMediaSource ready state not open!");r="audio"===a?ie.AUDIO:"mp4a"===o?ie.MIX:ie.VIDEO;var u=new ir(r,he(this,pr),this,he(this,yr));return this.sourceBuffers.push(u),u.mode="segments",this.sourceBuffers.dispatchEvent(new Event("addsourcebuffer")),this.activeSourceBuffers.push(u),Pe(this.activeSourceBuffers,"addsourcebuffer"),u}},{key:"removeSourceBuffer",value:function(e){if(he(this,lr).log(he(this,cr),"remove SourceBuffer: ".concat(e)),-1===this.sourceBuffers.indexOf(e))throw new Error("SourceBuffer not in SourceBuffers");e.updating&&(e.abort(),Pe(e,"abort"),Pe(e,"updateend"));var t=this.activeSourceBuffers.indexOf(e);-1!==t&&(this.activeSourceBuffers.remove(t),Pe(this.activeSourceBuffers,"removesourcebuffer")),this.sourceBuffers.remove(this.sourceBuffers.indexOf(e))}},{key:"endOfStream",value:function(e){if(he(this,lr).log(he(this,cr),"endOfStream, isHEVC: ".concat(he(this,hr),", error: ").concat(e)),he(this,dr)!==$.OPEN)throw new DOMException("Failed to execute 'endOfStream' on 'MediaSource': The MediaSource's readyState is not 'open'.");for(var t=0;t<this.sourceBuffers.length;t++)if(this.sourceBuffers[t].updating)throw new Error("InvalidStateError, some BwoSourceBuffer is updating");he(this,br).call(this,e),he(this,pr).__endOfStream__(this)}},{key:"__deatch__",value:function(){pe(this,dr,$.CLOSED),pe(this,fr,NaN);for(var e=this.activeSourceBuffers.length;e>0;e--)this.activeSourceBuffers.remove(e-1);this.activeSourceBuffers.dispatchEvent(new Event("removesourcebuffer"));for(var t=this.sourceBuffers.length;t>0;t--)this.sourceBuffers.remove(t-1);this.sourceBuffers.dispatchEvent(new Event("removesourcebuffer")),Pe(this,"sourceclose"),he(this,lr).warn(he(this,cr),"source close")}}],[{key:"isTypeSupported",value:function(e){if(0===e.length)return!1;var t=e.match(or(/(video|audio)\/mp4;.*?codecs="(hev|mp4a|hvc).*?(,(hev|mp4a|hvc).*?|)"(;width="(.*?)";height="(.*?)"|)/,{mediaType:1,codec:2,codec2:4,width:6,height:7})),n=null==t?void 0:t.groups;if(t&&n){var r=n.mediaType,a=n.codec,i=(n.codec2,parseInt(n.width,10)),o=parseInt(n.height,10);if(!r||!a)return!1;var s={hev:!0,hvc:!0};if("video"===r&&(s[a]||s[a]))return!(i>=3840&&o>1080);if("audio"===r&&"mp4a"===a)return!0}return!1}}]),n}(be);O.getInstance().log("%c".concat("[WasmPlayer]"," version: ").concat(C,", build date: ").concat("Wed Dec 29 2021 15:21:26 GMT+0800 (中国标准时间)"),"color: #fb7299;"),window.customElements&&window.customElements.define&&!window.BwpElement&&(window.customElements.define("bwp-video",Un),window.BwpElement=Un,window.BwpMediaSource=gr);var Er={BwpElement:Un,BwpMediaSource:gr,BwpErrorCodes:oe,preloadBwp:Z,isBwpReady:function(){return X(),!Y||G||V||Z((function(){})),Boolean(Y&&G)},isBwpSupported:X}}(),r=r.default}()}));